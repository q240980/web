     (function(t){function e(e){for(var a,s,o=e[0],l=e[1],c=e[2],u=0,h=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,o=1;o<r.length;o++){var l=r[o];0!==i[l]&&(a=!1)}a&&(n.splice(e--,1),t=s(s.s=r[0]))}return t}var a={},i={app:0},n=[];function s(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=a,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(r,a,function(e){return t[e]}.bind(null,a));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";var a=r("85ec"),i=r.n(a);i.a},"07c7":function(t,e,r){"use strict";var a=r("ec2e"),i=r.n(a);i.a},"385b":function(t,e,r){},"3a4d":function(t,e,r){"use strict";var a=r("385b"),i=r.n(a);i.a},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{height:"100%"},attrs:{id:"app"}},["/login"===t.$route.path?r("div",[r("router-view")],1):t.$store.getters["user/isLogin"]?r("el-container",{attrs:{direction:"vertical"}},[r("el-header",[r("div",{staticClass:"uer-buttons",on:{click:t.logout}},[t._v(t._s(t.$store.getters["user/username"])+" 退出")]),r("h1",[t._v(t._s(t.$route.meta.title))]),r("my-menu-button")],1),r("el-container",[r("el-aside",{attrs:{width:"auto"}},[r("my-menu",{directives:[{name:"show",rawName:"v-show",value:t.$store.getters.menuIsOpen,expression:"$store.getters.menuIsOpen"}]})],1),r("el-main",{staticStyle:{height:"100%",padding:"0"}},[r("transition",[r("router-view")],1)],1)],1)],1):t._e()],1)},n=[],s=(r("96cf"),r("1da1")),o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",t._l(t.routes,(function(e,a){return r("div",{key:a,staticClass:"menu-row",class:{active:e.path===t.$route.path},on:{click:function(r){return t.activeRouter(e.path)}}},[r("el-row",[r("div",{staticClass:"menu-item"},[r("i",{class:e.meta.icon}),r("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.meta.title))])])])],1)})),0)},l=[],c=(r("4de4"),{name:"MyMenu",data:function(){return{routes:{}}},computed:{getIndex:function(t){return"/shop/image"}},methods:{activeRouter:function(t){t!==this.$route.path&&this.$router.push(t)}},mounted:function(){this.routes=this.$router.options.routes.filter((function(t){try{return t.meta.menu}catch(e){return!1}}))}}),d=c,u=(r("b205"),r("2877")),h=Object(u["a"])(d,o,l,!1,null,"634ea539",null),m=h.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{position:"fixed",left:"0.8em",top:"0","font-size":"2em"}},[r("i",{staticClass:"el-icon-menu",on:{click:t.changeMenu}})])},f=[],p={name:"MyMenuButton",methods:{changeMenu:function(){this.$store.dispatch("changeMenuStatus")}}},v=p,y=Object(u["a"])(v,g,f,!1,null,null,null),w=y.exports,b=r("5530"),k=(r("d3b7"),r("bc3a")),_=r.n(k),x=r("8c4f"),I=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-form",{ref:"loginForm",staticClass:"login-box",attrs:{model:t.loginForm,rules:t.rules,"label-position":"left","label-width":"100px"}},[r("el-row",[r("el-col",{staticClass:"hidden-xs-only d-hidden",attrs:{sm:6,md:8}},[t._v("123")]),r("el-col",{staticClass:"mt-4 login-form",attrs:{span:24,sm:12,md:8}},[t.hasToken?r("el-row",[r("el-col",{attrs:{span:24}},[r("h1",{staticClass:"title"},[t._v("服务器维护")])]),r("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[r("el-button",{attrs:{size:"large",type:"danger"},on:{click:t.loginOut}},[t._v("重新登陆")])],1),r("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[r("el-button",{attrs:{size:"large",type:"success"},on:{click:t.retryLogin}},[t._v("刷新重试")])],1)],1):r("el-row",[r("el-col",{attrs:{span:24}},[r("h1",{staticClass:"title"},[t._v("欢迎登陆!")])]),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"用户名:",prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入用户名",name:"username",maxlength:"16"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1)],1),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"密码:",prop:"password"}},[r("el-input",{attrs:{placeholder:"请输入密码","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitForm(e)}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1)],1),r("el-col",[r("el-form-item",{attrs:{label:"登录时效",prop:"expire"}},[r("el-select",{attrs:{placeholder:"请选择登录过期时间"},model:{value:t.loginForm.expire,callback:function(e){t.$set(t.loginForm,"expire",e)},expression:"loginForm.expire"}},[r("el-option",{attrs:{label:"1小时",value:"1"}}),r("el-option",{attrs:{label:"12小时",value:"12"}}),r("el-option",{attrs:{label:"1天",value:"24"}}),r("el-option",{attrs:{label:"7天",value:"168"}}),r("el-option",{attrs:{label:"15天",value:"360"}}),r("el-option",{attrs:{label:"1个月",value:"720"}}),r("el-option",{attrs:{label:"6个月",value:"4320"}}),r("el-option",{attrs:{label:"1年",value:"8640"}})],1)],1)],1),r("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[r("el-button",{attrs:{loading:null===t.captcha,size:"large",type:"primary"},on:{click:t.submitForm}},[t._v("登陆")])],1)],1)],1)],1)],1)],1)},S=[],$={data:function(){return{token:!1,hasToken:!1,loading:null,captcha:null,loginForm:{username:"",password:"",expire:"12",vaptchaToken:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[0-9a-zA-Z_-]+$/,message:"用户名只能包含数字、字母及_-"},{pattern:/^[a-zA-Z]/,message:"用户名请以字母开头"},{min:6,max:16,message:"长度在 6 到 16 个字符"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码最少8位"}]}}},mounted:function(){var t=this;this.$vaptcha.getInvisibleVaptcha().then((function(e){e.listen("pass",(function(){t.loginForm.vaptchaToken=e.getToken(),t.doLogin()})),t.captcha=e})).catch((function(e){t.$alert("验证码载入失败!请刷新(F5)页面重试!")}))},methods:{loginOut:function(){localStorage.clear(),this.hasToken=!1},retryLogin:function(){var t=this,e=this.token,r=this.$nr.loading("正在检测登录状态");ye(e).then((function(a){r.close(),t.$store.dispatch("user/successLogin",e),"/login"==t.$route.path&&t.$router.push({name:"index"})})).catch((function(e){t.$nr.alert(e.code+":"+e.message),r.close()}))},doLogin:function(){var t=this,e=this.$nr.loading("正在登陆...");ve(this.loginForm).then((function(r){e.close(),200===r.code?(t.$store.commit("user/setToken",r.data.token),t.$router.push("/shop/index")):t.failLogin(r)})).catch((function(r){e.close(),t.failLogin(r)}))},failLogin:function(t){this.loginForm.vaptchaToken="",this.captcha.reset(),this.$nr.reqErr(t)},submitForm:function(){var t=this;this.$refs["loginForm"].validate((function(e){if(!e)return t.$message({message:"请输入正确的用户名和密码",type:"error"}),!1;t.captcha.validate()}))}},created:function(){if("logout"===this.$route.query.action)localStorage.clear(),this.hasToken=!1,this.$store.dispatch("user/logout");else if(this.$store.getters["user/isLogin"]&&"/login"!=this.$route.path)this.$router.push("/shop/index");else{var t=localStorage.token;if(void 0!==t){var e=/^\d+\|[a-zA-Z][0-9a-zA-Z]{5,15}\|[0-9a-z]{32}$/;e.test(t)&&(this.token=t,this.hasToken=!0)}}}},L=$,C=(r("3a4d"),Object(u["a"])(L,I,S,!1,null,"5a14b4f8",null)),M=C.exports,A=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},P=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h3",[t._v("欢迎使用手机壳定制系统")])])}],O={},T=O,E=Object(u["a"])(T,A,P,!1,null,null,null),j=E.exports,N=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{height:"100%"}},[r("el-row",{staticStyle:{height:"100%"}},[r("el-col",{staticStyle:{height:"100%"}},[r("my-list",{attrs:{list:t.filterList,load:t.loadMoreIsBusy||t.search.loading,hasMore:t.hasMore},on:{loadMore:t.loadMore}},[r("div",{style:{padding:"20px","padding-bottom":""!=t.$store.getters["order/list/getPrinterName"]?0:"20px"},attrs:{slot:"header"},slot:"header"},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-button",{ref:"refreshButton",attrs:{loading:t.refresh.loading,type:"primary",size:"medium"},on:{click:t.loadNew}},[t._v("刷新")]),r("el-button",{attrs:{loading:t.refresh.loading,type:"primary",size:"medium",icon:"el-icon-setting"},on:{click:t.chosePrinter}},[t._v("打印机")])],1),r("el-col",{attrs:{span:8}},[r("el-radio-group",{attrs:{fill:t._f("statusColor")(t.options.status),size:"medium"},model:{value:t.options.status,callback:function(e){t.$set(t.options,"status",e)},expression:"options.status"}},[r("el-radio-button",{attrs:{label:"-1"}},[t._v("全部")]),r("el-radio-button",{attrs:{label:"1"}},[t._v("新订单")]),r("el-radio-button",{attrs:{label:"2"}},[t._v("已完成")]),r("el-radio-button",{attrs:{label:"0"}},[t._v("已取消")])],1)],1),r("el-col",{attrs:{span:10}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom"}},[r("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 可输入型号、订单编号、买家名称"),r("br"),t._v(" 本地数据最多缓存5000条"),r("br"),t._v(" 订单号:需客户提供"),r("br"),t._v(" 订单号支持服务器搜索"),r("br")]),r("el-input",{attrs:{size:"medium",disabled:t.search.loading,placeholder:"请输入。。。"},on:{input:t.resetGetOrderById},model:{value:t.search.keywords,callback:function(e){t.$set(t.search,"keywords",e)},expression:"search.keywords"}},[t.keywordsById&&0===t.keywordsByIdList.length?r("el-button",{attrs:{slot:"append",loading:t.search.loading,icon:"el-icon-search"},on:{click:t.getOrderById},slot:"append"}):t._e()],1)],1)],1),""!=t.$store.getters["order/list/getPrinterName"]?r("el-col",{staticStyle:{"margin-top":"1em"}},[t._v(" 当前打印机:"+t._s(t.$store.getters["order/list/getPrinterName"])+" ")]):t._e()],1)],1)])],1)],1),t.$store.getters["order/list/printerSettingIsShow"]?r("PrinterSetting"):t._e()],1)},F=[],z=(r("99af"),r("4160"),r("fb6a"),r("45fc"),r("4d63"),r("ac1f"),r("25f0"),r("466d"),r("5319"),r("841c"),r("159b"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"content",staticClass:"vue-list",on:{scroll:t.handleScroll}},[r("div",{ref:"list"},[r("el-row",[r("el-col",{ref:"headerSolt"},[t._t("header")],2)],1),r("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.load,expression:"load"}],style:{paddingTop:t.paddingTop+"px",paddingBottom:t.paddingBottom+"px"}},[t._l(t.viewList,(function(e){return r("el-col",{key:e.id,ref:"item",refInFor:!0,staticClass:"order-item",staticStyle:{padding:"20px"}},[r("el-row",{staticClass:"table-order",style:t._f("statusBorderColor")(e.status)},[r("el-col",{staticClass:"number",class:t._f("statusClass")(e.status)},[r("el-col",{attrs:{span:3}},[t._v("订单号:"+t._s(e.order_id))]),r("el-col",{attrs:{span:15}},[t._v("订单编号:"+t._s(e.order_number))]),r("el-col",{staticClass:"status",attrs:{span:6}},[t._v(t._s(t._f("statusText")(e.status)))])],1),r("el-col",{staticClass:"content"},[r("el-col",{attrs:{span:6}},[r("el-image",{staticStyle:{width:"100%",height:"6em"},attrs:{src:e.thumbnailSrc,fit:"contain"}})],1),r("el-col",{staticClass:"desc",attrs:{span:6}},[r("div",[t._v("型号:"+t._s(e.brand_name)+t._s(e.series_name)+t._s(e.model_name))]),r("div",[t._v("素材:"+t._s(e.material_name))]),r("div",[t._v("下单时间:"+t._s(e.create_time))])]),r("el-col",{staticClass:"desc",attrs:{span:6}},[r("div",[t._v("买家:"+t._s(e.user_name))]),r("div",[t._v("留言:什么也没留下")])]),r("el-col",{staticClass:"action",attrs:{span:6}},[r("div",[r("el-button",{attrs:{loading:e.loading,type:"primary",size:"mini"},on:{click:function(r){return t.handleOrder(e,!1)}}},[t._v("下载"),r("i",{staticClass:"el-icon-download el-icon--right"})])],1),r("div",[""!=t.printer.name?r("el-button",{attrs:{loading:e.loading,type:"primary",size:"mini"},on:{click:function(r){return t.handleOrder(e,!0)}}},[t._v("打印"+t._s(t.printer.preview?"预览":"")),r("i",{staticClass:"el-icon-printer el-icon--right"})]):t._e()],1),2!=e.status?r("div",[r("el-button",{attrs:{loading:e.loading,type:"success",size:"mini"},on:{click:function(r){return t.changeOrderStatus(e,2)}}},[t._v("完成"),r("i",{staticClass:"el-icon-check el-icon--right"})])],1):t._e(),2!=e.status&&0!=e.status?r("div",[r("el-button",{attrs:{loading:e.loading,type:"danger",size:"mini"},on:{click:function(r){return t.changeOrderStatus(e,0)}}},[t._v("取消"),r("i",{staticClass:"el-icon-delete el-icon--right"})])],1):t._e()])],1)],1)],1)})),r("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[0!=t.viewList.length||t.load?t._e():r("h1",[t._v("什么也没有!")])])],2)],1),r("el-backtop",{attrs:{target:".vue-list"}},[r("div",{staticStyle:{"{\n        height":"100%",width:"100%","background-color":"#f2f5f6","box-shadow":"0 0 6px rgba(0,0,0, .12)","text-align":"center","line-height":"40px",color:"#1989fa"}},[t._v(" UP ")])])],1)}),B=[],D=(r("cb29"),r("caad"),r("b0c0"),r("a9e3"),r("b680"),r("2532"),r("c975"),null);function G(){try{var t=navigator.userAgent;if(null!=t.match(/Windows\sPhone/i))return!0;if(null!=t.match(/iPhone|iPod/i))return!0;if(null!=t.match(/Android/i))return!0;if(null!=t.match(/Edge\D?\d+/i))return!0;var e=t.match(/Trident\D?\d+/i),r=t.match(/MSIE\D?\d+/i),a=t.match(/OPR\D?\d+/i),i=t.match(/Firefox\D?\d+/i),n=t.match(/x64/i);if(null==e&&null==r&&null!==n)return!0;if(null!==i){if(i=i[0].match(/\d+/),i[0]>=42||null!==n)return!0}else if(null!==a){if(a=a[0].match(/\d+/),a[0]>=32)return!0}else if(null==e&&null==r){var s=t.match(/Chrome\D?\d+/i);if(null!==s&&(s=s[0].match(/\d+/),s[0]>=42))return!0}return!1}catch(o){return!0}}if(G()){var R=document.head||document.getElementsByTagName("head")[0]||document.documentElement,q=document.createElement("script");q.src="https://localhost.lodop.net:8443/CLodopfuncs.js?priority=1",R.insertBefore(q,R.firstChild)}function U(t,e){var r,a="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop32.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",i="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop32.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",n="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='install_lodop64.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",s="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='install_lodop64.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",o="<br><br><font color='#FF00FF'>（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）</font>",l="<br><br><font color='#FF00FF'>(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）</font>",c="<br><font color='#FF00FF'>CLodop云打印服务需升级!点击这里<a href='CLodop_Setup_for_Win32NT.exe' target='_self'>执行升级</a>,升级后请刷新页面。</font>";try{var d=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0;if(G()){try{r=getCLodop()}catch(h){}if(!r&&"complete"!==document.readyState)return void alert("打印组件C-Lodop没准备好，请稍后再试！");r&&(CLODOP.CVERSION<"3.0.0.2"&&(d?document.write(c):document.documentElement.innerHTML=c+document.documentElement.innerHTML),e&&e.parentNode&&e.parentNode.removeChild(e),t&&t.parentNode&&t.parentNode.removeChild(t))}else{var u=d&&navigator.userAgent.indexOf("x64")>=0;if(void 0!=t||void 0!=e?r=d?t:e:null==D?(r=document.createElement("object"),r.setAttribute("width",0),r.setAttribute("height",0),r.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;"),d?r.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA"):r.setAttribute("type","application/x-print-lodop"),document.documentElement.appendChild(r),D=r):r=D,null==r||"undefined"==typeof r.VERSION)return navigator.userAgent.indexOf("Chrome")>=0&&(document.documentElement.innerHTML=l+document.documentElement.innerHTML),navigator.userAgent.indexOf("Firefox")>=0&&(document.documentElement.innerHTML=o+document.documentElement.innerHTML),u?document.write(n):d?document.write(a):document.documentElement.innerHTML=a+document.documentElement.innerHTML,r}return r.VERSION<"6.0"?(G()||(u?document.write(s):d?document.write(i):document.documentElement.innerHTML=i+document.documentElement.innerHTML),r):r}catch(h){return h}}var W={name:"MyList",props:{list:{type:Array,required:!0,default:[],twoWays:!0},above:{type:Number,default:1},below:{type:Number,default:1},load:{type:Boolean,default:!1}},data:function(){return{test:{count:1},hasMore:!1,viewList:[],scroll:{realTop:0,top:0,busy:!1},width:{list:0,item:0},height:{top:0,bottom:0,item:0,page:0,header:0}}},watch:{list:function(t){0===this.height.item&&this.list.length>0&&(this.viewList=this.list.slice(0,1)),this.scroll.top=0,this.scroll.busy=!1,this.handleScroll()},viewList:function(t){var e=this;this.height.page=this.$el.offsetHeight,this.width.list=this.$el.offsetWidth,this.$nextTick((function(){if(0===e.height.item&&t.length>0){e.height.item=e.$refs["item"][0].$el.getBoundingClientRect().height,e.width.item=e.$refs["item"][0].$el.getBoundingClientRect().width,e.height.header=e.$refs["headerSolt"].$el.getBoundingClientRect().height;var r=(1+e.below)*e.itemsInPgae*e.itemsInRow;e.viewList=e.list.slice(0,r)}}))}},computed:{printer:function(){return this.$store.getters["order/list/getPrinter"]},itemsInPgae:function(){return this.height.page>0&&this.height.item>0?Math.ceil(this.height.page/this.height.item)*this.itemsInRow:10},displayFrist:function(){return Math.ceil(this.scroll.top/this.height.item)*this.itemsInRow},itemsInRow:function(){return parseInt(this.width.list/this.width.item)},start:function(){var t=this.displayFrist-this.above*this.itemsInPgae;return t<0&&(t=0),t<0?0:Math.ceil(t)},end:function(){var t;return t=0==this.start?(1+this.below)*this.itemsInPgae:this.start+(this.above+1+this.below)*this.itemsInPgae,t<this.list.length?Math.ceil(t):this.list.length},paddingTop:function(){return this.start/this.itemsInRow*this.height.item},paddingBottom:function(){return(this.list.length-this.end)*this.height.item/this.itemsInRow},listHeight:function(){return this.list.length*this.height.item/this.itemsInRow}},filters:{statusText:function(t){var e="";switch(t*=1,t){case 0:e="已取消";break;case 1:e="新订单";break;case 2:e="已完成";break;default:e="未知状态:"+t}return e},statusClass:function(t){var e="";switch(t*=1,t){case 0:e="danger";break;case 1:e="primary";break;case 2:e="success";break;default:e="other"}return"bg-"+e},statusBorderColor:function(t){var e="";switch(t*=1,t){case 0:e="#F56C6C";break;case 2:e="#67C23A";break;default:e="#409EFF"}return"border:1px solid "+e}},created:function(){0===this.height.item&&this.list.length>0&&(this.viewList=this.list.slice(0,1))},methods:{handleOrder:function(t,e){t.loading=!0,e=!0===e;var r=t.brand_name+t.series_name+t.model_name;this.canvasImage(t,{order_id:t.order_id,model_name:r+" "+t.material_name,width:t.material_width,height:t.material_height,user_name:t.user_name,message:"什么也没留下！",src:t.downloadSrc},e)},reverseImage:function(t){return new Promise((function(e){var r=document.createElement("canvas");r.width=t.width,r.height=t.height;var a=r.getContext("2d");a.scale(-1,1),a.drawImage(t,-t.width,0,t.width,t.height),requestAnimationFrame((function(){var t=new Image;t.onload=function(){e(t)},t.src=r.toDataURL("image/png")}))}))},radiusImage:function(t,e){return new Promise((function(r){var a=document.createElement("canvas"),i=t.width,n=t.height;a.width=i,a.height=n;var s=a.getContext("2d");s.drawImage(t,0,0,i,n),s.globalCompositeOperation="destination-in",s.beginPath(0),s.arc(i-e,n-e,e,0,Math.PI/2),s.lineTo(e,n),s.arc(e,n-e,e,Math.PI/2,Math.PI),s.lineTo(0,e),s.arc(e,e,e,Math.PI,3*Math.PI/2),s.lineTo(i-e,0),s.arc(i-e,e,e,3*Math.PI/2,2*Math.PI),s.lineTo(i,n-e),s.closePath(),s.fill(),requestAnimationFrame((function(){var t=new Image;t.onload=function(){r(t)},t.src=a.toDataURL("image/png")}))}))},rotateImage:function(t,e){return new Promise((function(r){var a=document.createElement("canvas"),i=a.getContext("2d");e%2===0?(a.width=t.width,a.height=t.height):(a.width=t.height,a.height=t.width),i.save(),i.translate(a.width/2,a.height/2),i.rotate(90*e*Math.PI/180),i.drawImage(t,-t.width/2,-t.height/2),i.restore(),requestAnimationFrame((function(){var t=new Image;t.onload=function(){r(t)},t.src=a.toDataURL("image/png")}))}))},addBorder:function(t,e){return new Promise((function(r){var a=document.createElement("canvas"),i=a.getContext("2d");a.width=t.width+2*e,a.height=t.height+2*e,i.lineWidth=e,i.strokeStyle="#000000",i.rect(e/2,e/2,t.width+e,t.height+e),i.stroke(),i.drawImage(t,e,e),requestAnimationFrame((function(){var t=new Image;t.onload=function(){r(t)},t.src=a.toDataURL("image/png")}))}))},addText:function(t,e){return new Promise((function(r){var a=[];"string"===typeof e?a.push(e):a=e;var i=document.createElement("canvas"),n=i.getContext("2d"),s=48;i.width=t.width,i.height=t.height+1.2*s*a.length,n.font=s+"px Arial",n.fillStyle="#000000",a.forEach((function(e,r){n.fillText(e,0,t.height+r*s*1.2+1.1*s,t.width)})),n.drawImage(t,0,0),requestAnimationFrame((function(){var t=new Image;t.onload=function(){r(t)},t.src=i.toDataURL("image/png")}))}))},imageToBase64:function(t){return new Promise((function(e){if("data:image"===t.src.substring(0,10))e(t);else{var r=document.createElement("canvas"),a=r.getContext("2d");r.width=t.width,r.height=t.height,a.drawImage(t,0,0),requestAnimationFrame((function(){var t=new Image;t.onload=function(){e(t)},t.src=r.toDataURL("image/png")}))}}))},canvasImage:function(t,e,r){var a=this,i=this,n=new Image;n.crossOrigin="Anonymous",n.onerror=function(){t.loading=!1,i.$nr.errMsg("图片加载失败")},n.onload=Object(s["a"])(regeneratorRuntime.mark((function s(){var o,l,c,d,u,h,m,g,f,p,v,y,w;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(o=e.order_id+"_"+e.model_name+".png",l=300/2.54,c=i.printer,d=n,1!=t.material_reverse){s.next=9;break}return s.next=7,a.reverseImage(d);case 7:d=s.sent;case 9:if(1!=t.material_radius){s.next=14;break}return s.next=12,a.radiusImage(d,l*t.material_radius_size);case 12:d=s.sent;case 14:if(r){s.next=35;break}if(!(t.material_rotate>0)){s.next=21;break}return s.next=19,a.rotateImage(d,t.material_rotate);case 19:d=s.sent;case 21:u=document.createElement("canvas"),h=d.width,m=d.height,u.setAttribute("width",h),u.setAttribute("height",m),g=u.getContext("2d"),g.drawImage(d,0,0,h,m),f=u.toDataURL("image/png"),t.loading=!1,i.saveFile(f,o),i.$nr.doneMsg("下载订单"),1==c.autoDone&&i.changeOrderStatus(t,2),s.next=78;break;case 35:if(p=U(),p.SET_PRINTER_INDEX(c.name)){s.next=43;break}return t.loading=!1,a.$nr.errMsg("打印机【"+c.name+"】异常"),s.abrupt("return");case 43:case 44:if(v=c.line?c.lineWidth:0,!(c.line>0&&1!=t.material_radius)){s.next=49;break}return s.next=48,a.addBorder(d,v);case 48:d=s.sent;case 49:if(y=[],c.print_text.includes("订单编号")&&y.push("订单编号:"+e.order_id),c.print_text.includes("素材信息")&&y.push("素材信息:"+e.model_name),c.print_text.includes("买家昵称")&&y.push("买家昵称:"+e.user_name),c.print_text.includes("买家留言")&&y.push("买家留言:"+e.message),!(y.length>0)){s.next=58;break}return s.next=57,a.addText(d,y);case 57:d=s.sent;case 58:return s.next=60,a.rotateImage(d,3);case 60:return d=s.sent,s.next=63,a.imageToBase64(d);case 63:if(d=s.sent,p.PRINT_INIT(o),p.SET_PRINT_PAGESIZE(0,c.paperWidth+"cm",(c.preview?c.paperHeight:1*c.paperHeight+30)+"cm"),!(c.paddingTop+d.height/l>c.paperHeight||c.paddingLeft+d.width/l>c.paperWidth)){s.next=73;break}return w={image:{width:c.paddingLeft+d.width/l,height:c.paddingTop+d.height/l},paper:{width:c.paperWidth,height:c.paperHeight}},i.$nr.alert("输出尺寸:"+w.image.width.toFixed(2)+"cm*"+w.image.height.toFixed(2)+"cm<br>纸张尺寸:"+w.paper.width.toFixed(2)+"cm*"+w.paper.height.toFixed(2)+"cm<br>","纸张过小"),t.loading=!1,s.abrupt("return",!1);case 73:p.ADD_PRINT_IMAGE(c.paddingTop+"cm",c.paddingLeft+"cm",d.width/l+"cm",d.height/l+"cm",d.src),p.SET_PRINT_STYLEA(0,"Stretch",1),c.preview?(p.PREVIEW(),i.$nr.doneMsg("已向["+c.name+"]发送打印预览!")):(p.PRINT(),1==c.autoDone?i.changeOrderStatus(t,2):i.$nr.doneMsg("已向["+c.name+"]发送打印任务!")),t.loading=!1;case 78:case"end":return s.stop()}}),s)}))),n.src=e.src},changeOrderStatus:function(t,e){var r=this;t.status!=e?(t.loading=!0,this.$store.dispatch("order/list/changeOrderStatus",{order_id:t.order_id,status:e}).then((function(e){r.$nr.reqSuc(e.message),t.loading=!1})).catch((function(e){r.$nr.reqErr(e),t.loading=!1}))):t.loading=!1},saveFile:function(t,e){var r=document.createElementNS("http://www.w3.org/1999/xhtml","a");r.href=t,r.download=e;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(a)},handleScroll:function(){var t=this;if(this.scroll.realTop=this.$el.scrollTop,!0!==this.scroll.busy){var e=this.scroll.realTop,r=this.paddingTop+this.height.header,a=this.listHeight-this.paddingBottom-this.height.page;if(e>a||e<r){this.scroll.busy=!0,this.scroll.top=this.$el.scrollTop;var i=40;this.listHeight-e<this.height.page+i&&this.loadMore(),this.viewList=this.list.slice(this.start,this.end),this.$nextTick((function(){t.scroll.busy=!1}))}}},loadMore:function(){this.$emit("loadMore")}},components:{}},J=W,H=(r("07c7"),Object(u["a"])(J,z,B,!1,null,null,null)),K=H.exports,Q=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-dialog",{attrs:{width:"35%","destroy-on-close":"",center:"",visible:t.$store.getters["order/list/printerSettingIsShow"],"show-close":!1}},[r("div",{staticClass:"header-title",attrs:{slot:"title"},slot:"title"},[r("span",{staticClass:"title-age"},[t._v("设置中心")])]),r("el-tabs",{on:{"tab-click":t.handleTabClick},model:{value:t.tabActiveName,callback:function(e){t.tabActiveName=e},expression:"tabActiveName"}},[r("el-tab-pane",{attrs:{label:"打印机",name:"printerTab"}},[r("el-form",{ref:"printerForm",attrs:{model:t.printer,"label-width":"5em","label-position":"left"}},[r("el-form-item",{attrs:{label:"打印机:"}},[r("el-select",{attrs:{placeholder:"请选择打印机"},model:{value:t.printer.name,callback:function(e){t.$set(t.printer,"name",e)},expression:"printer.name"}},t._l(t.printers,(function(t){return r("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"预览模式"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 预览界面也可打印！"),r("br"),t._v(" 方便调试预览效果！ ")]),r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},on:{change:t.previewChange},model:{value:t.printer.preview,callback:function(e){t.$set(t.printer,"preview",e)},expression:"printer.preview"}})],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"自动完成"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 点击打印后是否自动将订单移动到已完成！ ")]),r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},on:{change:t.autoDoneChange},model:{value:t.printer.autoDone,callback:function(e){t.$set(t.printer,"autoDone",e)},expression:"printer.autoDone"}})],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"纸张宽度"}},[r("el-input",{attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"可小数"},model:{value:t.printer.paperWidth,callback:function(e){t.$set(t.printer,"paperWidth",e)},expression:"printer.paperWidth"}},[r("template",{slot:"append"},[t._v("CM")])],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"纸张高度"}},[r("el-input",{attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"可小数"},model:{value:t.printer.paperHeight,callback:function(e){t.$set(t.printer,"paperHeight",e)},expression:"printer.paperHeight"}},[r("template",{slot:"append"},[t._v("CM")])],2)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"左偏移"}},[r("el-input",{attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"可小数"},model:{value:t.printer.paddingLeft,callback:function(e){t.$set(t.printer,"paddingLeft",e)},expression:"printer.paddingLeft"}},[r("template",{slot:"append"},[t._v("CM")])],2)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"顶偏移"}},[r("el-input",{attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"可小数"},model:{value:t.printer.paddingTop,callback:function(e){t.$set(t.printer,"paddingTop",e)},expression:"printer.paddingTop"}},[r("template",{slot:"append"},[t._v("CM")])],2)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"辅助框"}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 仅对未开启圆角的素材有效 ")]),r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#666"},model:{value:t.printer.line,callback:function(e){t.$set(t.printer,"line",e)},expression:"printer.line"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[t.printer.line?r("el-form-item",{attrs:{"label-width":"0"}},[r("el-input",{attrs:{oninput:"value=value.replace(/[^-\\d]/g,'')",placeholder:t.placeholder.num},model:{value:t.printer.lineWidth,callback:function(e){t.$set(t.printer,"lineWidth",t._n(e))},expression:"printer.lineWidth"}},[r("template",{slot:"append"},[t._v("像素")])],2)],1):t._e()],1)],1),r("el-row",[r("el-col",[r("el-form-item",{attrs:{label:"输出选项"}},[r("el-checkbox-group",{model:{value:t.printer.print_text,callback:function(e){t.$set(t.printer,"print_text",e)},expression:"printer.print_text"}},[r("el-checkbox",{attrs:{label:"订单编号",name:"type"}}),r("el-checkbox",{attrs:{label:"素材信息",name:"type"}}),r("el-checkbox",{attrs:{label:"买家昵称",name:"type"}}),r("el-checkbox",{attrs:{label:"买家留言",name:"type"}})],1)],1)],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"下载",name:"downloadTab"}})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.saveOptions}},[t._v("保存设置")]),r("el-button",{on:{click:t.closeWindow}},[t._v("取消")])],1)],1)],1)},Z=[],V={name:"PrinterSetting",components:{},data:function(){var t=this;return{tabActiveName:"printerTab",printers:[],printer:{name:"",print_text:[],line:!1,lineWidth:1,autoDone:!1,show:!1,preview:!1,paperWidth:21,paperHeight:29.7,paddingLeft:0,paddingTop:0},placeholder:{num:"请输入数字"},rules:{num:[{validator:function(e,r,a){var i=/^[0-9]+$/;i.test(r)||a(new Error(t.placeholder.num)),a()},trigger:"change"}]}}},methods:{handleTabClick:function(t){},previewChange:function(t){t===this.printer.autoDone===!0&&(this.printer.autoDone=!1)},autoDoneChange:function(t){t===this.printer.preview===!0&&(this.printer.preview=!1)},saveOptions:function(){""!=this.printer.name?(this.printer.paperHeight=1*this.printer.paperHeight>0?1*this.printer.paperHeight:0,this.printer.paperWidth=1*this.printer.paperWidth>0?1*this.printer.paperWidth:0,this.printer.paddingLeft=1*this.printer.paddingLeft>0?1*this.printer.paddingLeft:0,this.printer.paddingTop=1*this.printer.paddingTop>0?1*this.printer.paddingTop:0,this.printer.lineWidth=1*this.printer.lineWidth>0?1*this.printer.lineWidth:0,this.$store.commit("order/list/setPrinterSetting",this.printer),this.$nr.doneMsg("打印机设置完成！")):this.$nr.errMsg("请选择打印机")},closeWindow:function(){this.$store.commit("order/list/hiddenPrinterSetting")}},created:function(){for(var t=U(),e=t.GET_PRINTER_COUNT(),r=0;r<e;r++){var a=t.GET_PRINTER_NAME(r);this.printers.unshift({name:a,value:a})}this.printer=Object.assign(this.printer,this.$store.getters["order/list/getPrinter"]),this.printer.show=!1}},Y=V,X=Object(u["a"])(Y,Q,Z,!1,null,null,null),tt=X.exports,et={computed:{localHasNew:function(){try{return this.$store.getters["order/list/getList"].forEach((function(t){if(1==t.status)throw new Error("")})),!1}catch(t){return!0}},orderList:function(){var t;return t=this.keywordsByIdList.length>0?this.keywordsByIdList:this.$store.getters["order/list/getList"],t},filterList:function(){var t,e=this;t=this.orderList;var r=this.search.keywords.toLowerCase().replace(" ",".+");r=new RegExp(r);var a=this.options.status,i=[],n=t.filter((function(t){if(0===i.length){if(t.order_id==e.search.keywords)return i.push(t),!1;var n=!0;if(-1!=a&&(n=a==t.status),""!=e.search.keywords){r.test(t.order_number)||r.test(t.keywords)||r.test(t.order_id)||(n=!1)}return n}return!1}));i.length>0&&(n=i);var s=!1;t.length>1&&this.search.keywords.match(/^\d+$/)&&(this.search.keywords>=t[0].order_id&&this.search.keywords<=t[t.length-1].order_id||this.search.keywords<=t[0].order_id&&this.search.keywords>=t[t.length-1].order_id)&&(s=!0);var o=0===i.length&&this.search.keywords.match(/^\d+$/)&&this.search.onServer&&!s;return o?(this.keywordsById=!0,this.$nextTick((function(){e.getOrderByIdFromCache()}))):this.keywordsById=!1,1==this.options.status&&n.reverse(),n.forEach((function(t){e.$set(t,"loading",!1),t.thumbnailSrc=e.getOrderImageThumbnailSrc(t.attachment_hash),t.downloadSrc=e.getOrderImageDownloadSrc(t.attachment_hash)})),n}},components:{MyList:K,PrinterSetting:tt},data:function(){return{keywordsByIdList:[],keywordsByIdListCache:[],keywordsById:!1,search:{keywords:"",order_id:0,onServer:!0,loading:!1},refresh:{loading:!1,lasttime:0},options:{status:1},lastGetListTime:0,page:{end:0,limit:100},list:[],hasMore:!0,loadMoreIsBusy:!1}},watch:{"search.keywords":function(t){""!=t&&(this.options.status=-1)}},filters:{statusColor:function(t){var e="";switch(t*=1,t){case 0:e="#F56C6C";break;case 2:e="#67C23A";break;default:e="#409EFF"}return e}},methods:{getOrderImageThumbnailSrc:function(t){return"https://cdn.kgf.nr159.com/order/image/"+t+"/thumbnail.jpg"},getOrderImageDownloadSrc:function(t){return"https://cdn.kgf.nr159.com/order/image/"+t+"/download"},resetGetOrderById:function(){this.keywordsByIdList=[],this.search.order_id=0,this.getOrderByIdTimeout&&(clearTimeout(this.getOrderByIdTimeout),this.getOrderByIdTimeout=!1)},getOrderByIdFromCache:function(){var t=this;this.getOrderByIdTimeout&&(clearTimeout(this.getOrderByIdTimeout),this.getOrderByIdTimeout=!1),this.search.order_id=parseInt(this.search.keywords);var e=this.search.order_id,r=!1;this.keywordsByIdListCache.some((function(a){if(a.order_id==e)return t.keywordsByIdList=a.data,t.keywordsById=!1,r=!0,!0})),r||(this.getOrderByIdTimeout=setTimeout((function(){t.getOrderById(e)}),500))},getOrderById:function(t){var e=this;return!(this.search.loading||t<1)&&(this.getOrderByIdTimeout&&(clearTimeout(this.getOrderByIdTimeout),this.getOrderByIdTimeout=!1),this.search.loading=!0,this.keywordsByIdListCache.some((function(e){return e.order_id==t}))?(this.search.loading=!1,!1):(this.keywordsByIdListCache.push({order_id:t,data:[],loading:!0}),void this.$store.dispatch("order/list/getById",t).then((function(r){e.keywordsByIdListCache.some((function(a){if(a.order_id===t)return a.data=r.data,e.keywordsByIdList=a.data,a.loading=!1,!0})),e.search.loading=!1})).catch((function(t){e.search.loading=!1,e.$nr.reqErr(t)}))))},chosePrinter:function(){try{LODOP=U(),this.$store.commit("order/list/showPrinterSetting")}catch(t){this.$alert('解决办法:<br>1.如已正确安装请确认打印组件已运行<br>2.如未安装请<a target="_blank" href="http://www.lodop.net/download.html">点击进入</a>Lopod官网下载<br>2.1下载Lodop发行包（windows版）<br>2.2运行包内CLodop_Setup_for_Win32NT.exe(全部默认即可)<br>2.3看到<strong><span style="color:#585">C-Lopod安装成功且已启动后</span></strong>返回当前页面按F5刷新',"没有找到Lopod打印组件",{dangerouslyUseHTMLString:!0})}},loadNew:function(){var t=this;if(this.localHasNew)return this.$nr.errMsg("请先完成当前订单!"),this.search.keywords="",void(this.options.status=1);this.refresh.loading=!0;var e=(new Date).getTime();e-this.refresh.lasttime>3e3?this.$store.dispatch("order/list/getBefore").then((function(e){t.refresh.lasttime=(new Date).getTime(),t.refresh.loading=!1,e.data.length>0&&(t.list=e.data.concat(t.list)),t.$nr.reqSuc(e)})).catch((function(e){t.refresh.lasttime=(new Date).getTime(),t.refresh.loading=!1,t.$nr.reqErr(e)})):setTimeout((function(){var e={data:[]};t.refresh.loading=!1,t.$nr.reqSuc(e)}),100)},loadMore:function(){var t=this;if(!this.loadMoreIsBusy&&this.hasMore&&""==this.search.keywords&&1!=this.options.status){this.loadMoreIsBusy=!0;this.page.end,this.page.end,this.page.limit;if(this.orderList.length>this.page.end+this.page.limit)this.list=this.list.concat(this.orderList.slice(this.page.end,this.page.end+this.page.limit)),this.page.end+=this.page.limit,this.$nextTick((function(){t.loadMoreIsBusy=!1}));else if(""==this.search.keywords){var e=this.$nr.loading("正在加载更多数据");this.$store.dispatch("order/list/getAfter").then((function(r){try{r.data.length!=r.limit&&(t.hasMore=!1),t.loadMoreIsBusy=!1,e.close(),t.loadMore()}catch(a){}})).catch((function(r){e.close(),t.hasMore=!1,t.loadMoreIsBusy=!1,t.$nr.reqErr(r)}))}}},loadAfter:function(){var t=this,e=this.$nr.loading("正在加载更多数据");this.$store.dispatch("order/list/getAfter").then((function(r){t.lastGetListTime=(new Date).getTime(),r.data.length!=r.limit&&(t.hasMore=!1),t.$nextTick((function(){t.loadMoreIsBusy=!1})),e.close()})).catch((function(r){e.close(),t.$nr.reqErr(r)}))}},created:function(){var t=this,e=this.$nr.loading("正在加载订单列表!...");this.$store.dispatch("order/list/getIndex").then((function(r){r.length!=r.data.limit&&(t.hasMore=!1),e.close(),t.loadMore()})).catch((function(t){e.close()}))}},rt=et,at=Object(u["a"])(rt,N,F,!1,null,null,null),it=at.exports,nt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading.page,expression:"loading.page"}],staticStyle:{position:"relative",padding:"20px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.addMaterial}},[t._v("新增素材"),r("i",{staticClass:"el-icon-circle-plus-outline el-icon--right"})])],1),r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{size:"medium",placeholder:"这里可以快速查找已添加的型号"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),r("el-col",{attrs:{height:"200px;background-color:#f0f"}},[r("el-table",{staticStyle:{"margin-top":"2em",width:"100%"},attrs:{data:t.materials,border:!0}},[r("el-table-column",{attrs:{label:"品牌("+t.brands.length+")",prop:"brand_name",filters:t.brands,"filter-method":t.filterHandler}}),r("el-table-column",{attrs:{prop:"series_name",label:"型号("+t.materials.length+")"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.series_name)+t._s(e.row.model_name)+" ")]}}])}),r("el-table-column",{attrs:{label:"名称",prop:"material_name",sortable:""}}),r("el-table-column",{attrs:{label:"模板",prop:"tpl_name"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("my-material",{attrs:{material:t.row,width:50,height:50}})]}}])}),r("el-table-column",{attrs:{width:"240",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticStyle:{"white-space":"nowrap",margin:"10px"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return t.editMaterial(e.$index,e.row)}}},[t._v("修改"),r("i",{staticClass:"el-icon-edit"})]),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return t.handleDelete(e.$index,e.row)}}},[t._v("删除"),r("i",{staticClass:"el-icon-delete"})])],1)]}}])},[r("template",{slot:"header"},[t._v(" 操作 ")])],2)],1)],1)],1),t.$store.getters["material/addIsShow"]?r("MyAdd",{attrs:{brandList:t.$store.getters["material/getBrandList"]}}):t._e()],1)},st=[],ot=(r("a630"),r("d81d"),r("3ca3"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"新增素材","show-close":!1,visible:t.$store.getters["material/addIsShow"]}},[r("input",{ref:"selectFiles",staticStyle:{display:"none"},attrs:{type:"file",size:"3",accept:".png"},on:{change:function(e){return t.selectFiles(e)}}}),r("el-form",{ref:"material",attrs:{model:t.material,rules:t.rules}},[r("el-row",[r("el-col",{style:t.select_style,attrs:{span:6}},[r("el-form-item",{attrs:{label:""}},[r("el-select",{attrs:{placeholder:"请选择品牌"},on:{change:t.brandChanged},model:{value:t.index.brand,callback:function(e){t.$set(t.index,"brand",e)},expression:"index.brand"}},t._l(t.brandList,(function(t,e){return r("div",{key:e},[r("el-option",{attrs:{label:t.name,value:e}})],1)})),0)],1)],1),r("el-col",{style:t.select_style,attrs:{span:6}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"请选择系列"},on:{change:t.seriesChanged},model:{value:t.index.series,callback:function(e){t.$set(t.index,"series",e)},expression:"index.series"}},t._l(t.seriesList,(function(t,e){return r("div",{key:e},[r("el-option",{attrs:{label:t.name,value:e}})],1)})),0)],1)],1),r("el-col",{style:t.select_style,attrs:{span:6}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"请选择型号"},on:{change:t.modelChanged},model:{value:t.index.model,callback:function(e){t.$set(t.index,"model",e)},expression:"index.model"}},t._l(t.modelList,(function(t,e){return r("div",{key:e},[r("el-option",{attrs:{label:t.name,value:e}})],1)})),0)],1)],1),r("el-col",{style:t.select_style,attrs:{span:6}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"请选择样式"},on:{change:t.styleChanged},model:{value:t.index.style,callback:function(e){t.$set(t.index,"style",e)},expression:"index.style"}},[r("div",[t._l(t.styleList,(function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:e}})})),r("el-option",{attrs:{label:"上传",value:"upload"}})],2)])],1)],1)],1),r("div",[r("el-row",[r("el-col",{ref:"labels",attrs:{span:12}},[r("el-row",[r("el-form-item",{attrs:{prop:"name"}},[r("el-input",{model:{value:t.material.name,callback:function(e){t.$set(t.material,"name",e)},expression:"material.name"}},[r("template",{slot:"prepend"},[t._v("名 称:")])],2)],1)],1),r("el-row",[r("el-form-item",{attrs:{prop:"width"}},[r("el-input",{model:{value:t.material.width,callback:function(e){t.$set(t.material,"width",e)},expression:"material.width"}},[r("template",{slot:"prepend"},[t._v("宽 度:")]),r("template",{slot:"append"},[t._v("CM")])],2)],1)],1),r("el-row",[r("el-form-item",{attrs:{prop:"height"}},[r("el-input",{model:{value:t.material.height,callback:function(e){t.$set(t.material,"height",e)},expression:"material.height"}},[r("template",{slot:"prepend"},[t._v("高 度:")]),r("template",{slot:"append"},[t._v("CM")])],2)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开启圆角",prop:"delivery"}},[r("el-tooltip",{staticClass:"item",attrs:{disabled:t.material.radius,effect:"dark",placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 下载、打印均有效 ")]),r("el-switch",{model:{value:t.material.radius,callback:function(e){t.$set(t.material,"radius",e)},expression:"material.radius"}})],1)],1)],1),r("el-col",{attrs:{span:12}},[t.material.radius?r("el-form-item",[r("el-input",{model:{value:t.material.radius_size,callback:function(e){t.$set(t.material,"radius_size",e)},expression:"material.radius_size"}},[r("template",{slot:"append"},[t._v("CM")])],2)],1):t._e()],1)],1),r("el-row",[r("el-form-item",{attrs:{label:"镜像翻转",prop:"delivery"}},[r("el-tooltip",{staticClass:"item",attrs:{disabled:t.material.reverse,effect:"dark",placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[t._v(" 下载、打印均有效 ")]),r("el-switch",{model:{value:t.material.reverse,callback:function(e){t.$set(t.material,"reverse",e)},expression:"material.reverse"}})],1)],1)],1)],1),r("el-col",{style:{height:t.materialSize.height+"px",width:t.materialSize.width+"px"},attrs:{span:12}},[t.material.model_id?r("div",{staticClass:"full"},[t.material.src||t.material.style.hash||t.material.hash?r("div",{staticClass:"full"},[r("my-material",{attrs:{width:t.materialSize.width,height:t.materialSize.height,material:t.material},nativeOn:{click:function(e){return t.$refs.selectFiles.click()}}})],1):r("div",{staticClass:"full center"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.selectFiles.click()}}},[t._v(" 上传 "),r("i",{staticClass:"el-icon-upload el-icon--right"})])],1)]):t._e()])],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){return t.$store.dispatch("material/hiddenAdd")}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary",loading:t.dispatchMaterial},on:{click:t.addMaterial}},[t._v("确 定")]),r("el-button",{attrs:{type:"primary"},on:{click:t.print}},[t._v("打印")])],1)],1)}),lt=[],ct=(r("07ac"),"ImageList");function dt(t){var e={token:t},r={method:"post",url:"/shop/get"+ct+"List",data:e};return pe(r)}function ut(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postAdd"+ct,data:e};return pe(r)}function ht(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postEdit"+ct,data:e};return pe(r)}function mt(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postDelete"+ct,data:e};return pe(r)}function gt(t){var e={token:t},r={method:"post",url:"/shop/get"+ct+"Token",data:e};return pe(r)}function ft(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/get"+ct+"VerifyStatus",data:e};return pe(r)}function pt(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postSetImageHome"+ct,data:e};return pe(r)}function vt(t,e){return e.headers={"Content-Type":"multipart/form-data"},_.a.post("https://upload-z2.qiniup.com",t,e).then((function(t){return Promise.resolve(t)})).catch((function(t){var e={};e.code=t.request.status;var r=[];r["200"]="操作执行成功。",r["298"]="部分操作执行成功。",r["400"]="请求报文格式错误。包括上传时，上传表单格式错误；URL 触发图片处理时，处理参数错误；[资源管理][rsHref] 或 持久化数据处理 (pfop) 操作请求格式错误。",r["401"]="认证授权失败。 包括密钥信息不正确；数字签名错误；授权已超时。",r["403"]="token中的key和put方法的key不一致;mimelimit类型限制;fsizelimit大小限制。",r["404"]="资源不存在。 包括空间资源不存在；镜像源资源不存在。",r["405"]="请求方式错误。 主要指非预期的请求方式。",r["406"]="上传的数据 CRC32 校验错误。",r["419"]="用户账号被冻结。",r["478"]="镜像回源失败。 主要指镜像源服务器出现异常。",r["503"]="服务端不可用。",r["504"]="服务端操作超时。",r["573"]="单个资源访问频率过高。",r["579"]="上传成功但是回调失败。 包括业务服务器异常；七牛服务器异常；服务器间网络异常。",r["599"]="服务端操作失败。",r["608"]="资源内容被修改。",r["612"]="指定资源不存在或已被删除。",r["614"]="目标资源已存在。",r["630"]="已创建的空间数量达到上限，无法创建新空间。",r["631"]="指定空间不存在。",r["640"]="调用列举资源 (list) 接口时，指定非法的marker参数。",r["701"]="在断点续上传过程中，后续上传接收地址不正确或ctx信息已过期。";try{e.message=r[e.code]}catch(i){e.message=t.request.statusText}e.errorSource="服务器错误";try{var a=JSON.parse(t.request.responseText);e.message=a.error}catch(n){}return Promise.reject(e)}))}var yt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.showMaterial?r("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"full center"},[r("div",{style:t.imgStyle},[t.imageSrc?r("img",{staticClass:"item",attrs:{src:t.imageSrc}}):t._e(),t.materialSrc?r("img",{staticClass:"item",attrs:{src:t.materialSrc}}):t._e()])]):t._e()},wt=[],bt={data:function(){return{materialSrcError:!1,loading:!1,materialStyleSize:{width:0,height:0},imgSize:{width:0,height:0}}},name:"HelloWorld",props:{width:Number,height:Number,hash:String,src:String,material:Object},computed:{boxStyle:function(){var t={width:"100%",height:"100%",display:"flex","align-items":"center","justify-content":"center"};return t},imageSrc:function(){return this.src},materialSrc:function(){if(this.materialSrcError)return!1;var t=this.material,e=!1,r=this.width<200&&this.height<200?"/thumbnail.png":"/download";return r=this.width<100&&this.height<100?"/mini.png":r,t.src?e=t.src:t.hash?e="https://n1.cdn.kgf.nr159.com:9527/material/shop/"+t.hash+r:t.style.hash&&(e="https://n1.cdn.kgf.nr159.com:9527/material/nr/"+t.style.hash+r),!1!==e&&this.setSize(e),e},materialSize:function(){var t,e=this.materialStyleSize,r={},a=this.material;if(a.width>0&&a.height>0){var i=this.width/this.height,n=a.width/a.height;i<n?(r.width=this.width,r.height=this.width/n):(r.height=this.height,r.width=this.height*n),t=r}else t=e;return t},imgStyle:function(){var t={position:"relative",overflow:"hidden","background-color":"#fff","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAQAAABKfvVzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAAi0lEQVR42mJ8+p8BK5BixC4OEEBMDCQCgAAiWQNAAJGsASCASNYAEEAkawAIIJI1AAQQyRoAAohkDQABRLIGgAAiWQNAAJGsASCAWHClmWc40hhAAJFsA0AAkawBIIBI1gAQQCRrAAggkjUABBDJGgACiGQNAAFEsgaAACJZA0AAkawBIIBI1gAQYAAFqwQxF8upowAAAABJRU5ErkJggg==)"},e=2;if(this.width>0&&this.height>0){var r={width:this.materialSize.width-2*e,height:this.materialSize.height-2*e};this.imgSize=r,t.width=r.width+"px",t.height=r.height+"px",e=r.width<r.height?.01*r.width:.01*r.height,t.border=e+"px solid #000000",this.material.radius_size>0&&this.material.radius?t["border-radius"]=this.radius_size+"px":t["border-radius"]=(this.materialSize.width<this.materialSize.height?.1*this.materialSize.width:.1*this.materialSize.height)+"px"}else t.display="none";return t},showMaterial:function(){this.width,this.height,this.hash||this.material.hash;return!0},radius_size:function(){var t=this.imgSize.width/this.material.width,e=this.material,r=e.radius_size*t;return r}},methods:{setSize:function(t){this.loading=!0;var e=this,r=new Image;r.onerror=function(){e.loading=!1,e.materialSrcError=!0},r.onload=function(){var t={},a=e.width/e.height,i=r.width/r.height;a<i?(t.width=e.width,t.height=e.width/i):(t.height=e.height,t.width=e.height*i),e.materialStyleSize=t,e.loading=!1},r.src=t}}},kt=bt,_t=(r("91bb"),Object(u["a"])(kt,yt,wt,!1,null,"33c0807b",null)),xt=_t.exports,It={name:"MyAdd",components:{myMaterial:xt},props:{brandList:Array},data:function(){return{materialSize:{width:0,height:0},dispatchMaterial:!1,select_style:{padding:"0 0.2em 0 0"},index:{brand:null,series:null,model:null,style:null},material:{brand_id:null,brand_name:null,model_id:null,model_name:null,keywords:null,series_id:null,series_name:null,style_id:null,style_name:null,width:null,height:null,name:null,radius:null,radius_size:null,reverse:null,src:"",hash:"",material_image_id:"",rotate:0,style:{}},rules:{name:[{required:!0,message:"请输入素材名称",trigger:"blur"},{min:1,max:5,message:"长度在 1 到 5 个字符",trigger:"blur"},{validator:function(t,e,r){/^([0-9a-zA-Z\u4e00-\u9fa5]{1,5})$/.test(e)?r():r(new Error("素材名称只能输入汉字、字母和数字"))},trigger:"blur"}],width:[{required:!0,message:"请输入型号宽度",trigger:"blur"},{validator:function(t,e,r){/^(([0-9]+)|([0-9]+\.[0-9]+))$/.test(e)?r():r(new Error("请输入正确的宽度"))},trigger:"blur"}],height:[{required:!0,message:"请输入型号高度",trigger:"blur"},{validator:function(t,e,r){/^(([0-9]+)|([0-9]+\.[0-9]+))$/.test(e)?r():r(new Error("请输入正确的高度"))},trigger:"blur"}]}}},methods:{selectFiles:function(t){this.material.style_id=0,this.material.style={},this.index.style="upload";var e=this,r=t.target.files[0];this.file=r;var a=this.$nr.loading("正在读取图片"),i=new FileReader;i.onload=function(t){var r=new Image;r.src=t.target.result,r.onerror=function(t){e.$nr.reqErr("图片加载失败"),a.close()},r.onload=function(){e.material.src=r.src,a.close()}},i.readAsDataURL(r)},uploadMaterialImage:function(){var t=this;return new Promise((function(e,r){var a=t.$nr.loading("获取上传令牌");t.$store.dispatch("material/getMaterialToken").then((function(i){a.close(),a=t.$nr.loading("正在上传素材图片");var n=new FormData;n.append("file",t.file),n.append("key",i.key),n.append("token",i.token);var s={};vt(n,s).then((function(t){a.close(),e(t.data.data)})).catch((function(e){a.close(),t.$nr.reqErr(e),r(e)}))})).catch((function(e){a.close(),t.$nr.reqErr(e),r(e)}))}))},addMaterial:function(){var t=this;this.$refs["material"].validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r){var a,i,n,s,o,l,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=25;break}a=!1,i=Object.values(t.index),n=0;case 4:if(!(n<i.length)){e.next=13;break}if(null!=i[n]){e.next=10;break}return s=document.getElementsByClassName("el-select"),s[n].click(),a=!0,e.abrupt("break",13);case 10:n++,e.next=4;break;case 13:if(a){e.next=25;break}if(!t.material.src){e.next=21;break}return e.next=17,t.uploadMaterialImage();case 17:o=e.sent,t.material.material_image_id=o.id,t.material.hash=o.hash,t.material.src="";case 21:t.dispatchMaterial=!0,l=t.$nr.loading("正在保存素材..."),c=t.$store.getters["material/isEdit"]?"material/edit":"material/add",t.$store.dispatch(c,t.material).then((function(e){t.dispatchMaterial=!1,l.close(),t.$store.commit("material/hiddenAdd")})).catch((function(e){t.dispatchMaterial=!1,l.close(),t.$nr.reqErr(e)}));case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},print:function(){},brandChanged:function(t){var e=document.getElementsByClassName("el-select");e[1].click();var r=this.brandList[this.index.brand];this.material.brand_id=r.id,this.material.brand_name=r.name},seriesChanged:function(t){var e=document.getElementsByClassName("el-select");e[2].click();var r=this.brandList[this.index.brand].seriess[t];this.material.series_id=r.id,this.material.series_name=r.name},modelChanged:function(t){var e=document.getElementsByClassName("el-select");e[3].click();var r=this.brandList[this.index.brand].seriess[this.index.series].models[t];this.material.model_id=r.id,this.material.model_name=r.name,this.material.keywords=r.keywords},styleChanged:function(t){if(this.material.src="","upload"===t)this.$refs.selectFiles.click();else{var e=this.brandList[this.index.brand].seriess[this.index.series].models[this.index.model].styles[t];this.material.style_id=e.id,this.material.style_name=e.name,this.material.name=null==this.material.name&&void 0!=e.name?e.name:this.material.name,this.material.width=null==this.material.width&&void 0!=e.width?e.width:this.material.width,this.material.height=null==this.material.height&&void 0!=e.height?e.height:this.material.height,this.material.style=e,this.material.hash=""}}},computed:{seriesList:function(){try{var t=this.brandList[this.index.brand].seriess;return this.index.series=null,t}catch(e){return this.index.series=null,[]}},modelList:function(){try{var t=this.brandList[this.index.brand].seriess[this.index.series].models;return this.index.model=null,t}catch(e){return this.index.model=null,[]}},styleList:function(){try{var t=this.brandList[this.index.brand].seriess[this.index.series].models[this.index.model].styles;return this.index.style=null,t}catch(e){return this.index.style=null,[]}}},mounted:function(){var t=this,e=this.materialSize;if(0===e.width&&this.$nextTick((function(){var r=t.$refs["labels"].$el;e.width=r.getBoundingClientRect().width,e.height=r.getBoundingClientRect().height})),this.$store.getters["material/isEdit"]){var r=this.$store.getters["material/getMaterial"];if(null!==r)try{this.brandList.forEach((function(e,a){e.id===r.brand_id&&(t.index.brand=a,t.seriesList.forEach((function(e,a){e.id===r.series_id&&(t.index.series=a,t.modelList.forEach((function(e,a){e.id===r.model_id&&(t.index.model=a,t.material=Object.assign(t.material,Object(b["a"])({},r)),t.material.radius=1==t.material.radius,t.material.reverse=1==t.material.reverse,t.material.rotate=t.material.rotate.toString(),t.material.name=t.material.material_name,t.$nextTick((function(){r.hash?t.index.style="upload":t.styleList.forEach((function(e,a){if(e.id===r.style_id)throw t.index.style=a,Error()}))})))})))})))}))}catch(a){}else this.$alert("获取素材数据失败!","错误")}}},St=It,$t=(r("d2ab"),Object(u["a"])(St,ot,lt,!1,null,"9d90b30e",null)),Lt=$t.exports,Ct=r("8237"),Mt=r.n(Ct),At={components:{MyAdd:Lt,myMaterial:xt},data:function(){return{loading:{page:!0},keywords:"",filterInput:"",multipleSelection:[],request:{},editMaterialId:0}},computed:{materials:function(){var t=this.$store.getters["material/getMaterialList"],e=this.keywords;if(""===e)return Array.from(t);e=e.replace(" ",".+");var r=new RegExp(e),a=t.filter((function(t){return r.test(t.keywords)||r.test(t.material_name)}));return a},brands:function(){var t=[],e=Array.from(this.request);return e.map((function(e){return inArray(e.brand_name,t)?null:(t.push(e.brand_name),{text:e.brand_name,value:e.brand_name})})).filter((function(t){return null!=t}))}},methods:{addMaterial:function(){this.$store.commit("material/addMaterial")},editMaterial:function(t,e){this.$store.commit("material/editMaterial",e.id)},handleDelete:function(t,e){var r=this,a=e.brand_name+e.series_name+e.model_name+e.material_name;this.$confirm("此操作将永久删除["+a+"]","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=r.$nr.loading("正在删除["+a+"]!...");r.$store.dispatch("material/delete",e).then((function(){t.close(),r.$message({type:"success",message:"删除["+a+"]成功!"})})).catch((function(e){t.close(),r.$nr.reqErr(e)}))}))},filterHandler:function(t,e,r){var a=r["property"];return e[a]===t},init:function(){var t=this,e=this.$nr.loading("正在获取素材列表...");this.$store.dispatch("material/getBrandList").then((function(){e.text="正在获取素材列表...",t.$store.dispatch("material/getMaterialList").then((function(r){e.close(),t.loading.page=!1})).catch((function(r){e.close(),t.$nr.reqErr(r)}))})).catch((function(r){e.close(),t.$nr.reqErr(r)}))}},mounted:function(){},created:function(){this.init()},destroyed:function(){this.$store.commit("material/destroyed")}},Pt=At,Ot=Object(u["a"])(Pt,nt,st,!1,null,null,null),Tt=Ot.exports,Et=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{padding:"20px"}},[r("input",{ref:"selectFiles",staticStyle:{display:"none"},attrs:{type:"file",size:"3",multiple:"multiplt",accept:".png,.jpg,.jpeg"},on:{change:function(e){return t.selectFiles(e)}}}),t.loading.page?[r("div",{staticStyle:{width:"100%",height:"100%"}})]:[r("el-row",{staticStyle:{"margin-bottom":"20px"}},[r("el-col",{attrs:{span:20}},[t.verifyList.length>0?r("el-button",{staticStyle:{"margin-right":"0.5em"},attrs:{type:"primary",size:"medium"},on:{click:t.updateVerifyStatus}},[t._v("更新审核状态")]):t._e(),t.$store.getters["image/list/getList"].length>0?r("div",{staticStyle:{display:"inline-block"}},[r("el-radio-group",{attrs:{size:"medium"},model:{value:t.filterStatus,callback:function(e){t.filterStatus=e},expression:"filterStatus"}},[r("el-radio-button",{attrs:{label:"-1"}},[t._v("全部")]),r("el-radio-button",{attrs:{label:"3"}},[t._v("推荐")]),r("el-radio-button",{attrs:{label:"1"}},[t._v("正常")]),r("el-radio-button",{attrs:{label:"2"}},[t._v("待审核")]),r("el-radio-button",{attrs:{label:"0"}},[t._v("未通过")])],1)],1):t._e()],1),r("el-col",{ref:"getImageWidth",attrs:{span:4}},[r("el-button",{attrs:{size:"medium",plain:""}},[t._v("容量:"+t._s(t.$store.getters["image/list/getList"].length)+"/"+t._s(t.$store.getters["image/list/getImageListMax"]))])],1)],1),r("el-row",[r("el-tabs",{attrs:{type:"border-card","before-leave":t.beforeChangeCategoryTab},on:{"tab-click":t.changeCategoryTab},model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[t._l(t.imageCategoryList,(function(e){return r("el-tab-pane",{key:e.id,attrs:{name:"tab_"+e.id,lazy:""}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(e.name)+" "),e.imageList.length>0?[t._v(" ("+t._s(e.imageList.length)+") ")]:t._e(),e.id==t.$store.getters["image/category/tabId"]?[r("i",{staticClass:"el-icon-edit",on:{click:function(r){return t.editCategory(e)}}})]:t._e(),e.id==t.$store.getters["image/category/tabId"]&&0===e.imageList.length?[r("i",{staticClass:"el-icon-delete",on:{click:function(r){return t.delCategory(e)}}})]:t._e()],2),e.id==t.$store.getters["image/category/tabId"]?r("el-row",[r("el-col",{staticClass:"image-list-div",attrs:{span:4}},[r("div",{staticClass:"image-list-border",on:{click:function(e){return t.$refs.selectFiles.click()}}},[r("img",{staticStyle:{width:"100%"},attrs:{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGFzcz0iYmkgYmktdXBsb2FkIj4NCg0KIDxnPg0KICA8dGl0bGU+YmFja2dyb3VuZDwvdGl0bGU+DQogIDxyZWN0IGZpbGw9Im5vbmUiIGlkPSJjYW52YXNfYmFja2dyb3VuZCIgaGVpZ2h0PSI0MDIiIHdpZHRoPSIyMDIiIHk9Ii0xIiB4PSItMSIvPg0KIDwvZz4NCiA8Zz4NCiAgPHRpdGxlPkxheWVyIDE8L3RpdGxlPg0KICA8ZyBpZD0ic3ZnXzMiPg0KICAgPHBhdGggaWQ9InN2Z18xIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Im00Ny42MjUsMTcwLjU1MjczYTMuNjI1LDMuNjI1IDAgMCAxIDMuNjI1LDMuNjI1bDAsMjUuMzc1YTcuMjUsNy4yNSAwIDAgMCA3LjI1LDcuMjVsODcsMGE3LjI1LDcuMjUgMCAwIDAgNy4yNSwtNy4yNWwwLC0yNS4zNzVhMy42MjUsMy42MjUgMCAwIDEgNy4yNSwwbDAsMjUuMzc1YTE0LjUsMTQuNSAwIDAgMSAtMTQuNSwxNC41bC04NywwYTE0LjUsMTQuNSAwIDAgMSAtMTQuNSwtMTQuNWwwLC0yNS4zNzVhMy42MjUsMy42MjUgMCAwIDEgMy42MjUsLTMuNjI1em0zMi42MjUsLTIyLjgwODVhMy42MjUsMy42MjUgMCAwIDAgNS4xMjU3NSwwbDE2LjYyNDI1LC0xNi42MzE1bDE2LjYyNDI1LDE2LjYyNDI1YTMuNjI1LDMuNjI1IDAgMSAwIDUuMTI1NzUsLTUuMTI1NzVsLTE5LjE4MzUsLTE5LjE4MzVhMy42MjUsMy42MjUgMCAwIDAgLTUuMTMzLDBsLTE5LjE4MzUsMTkuMTgzNWEzLjYyNSwzLjYyNSAwIDAgMCAwLDUuMTMzeiIgZmlsbC1ydWxlPSJldmVub2RkIi8+DQogICA8cGF0aCBpZD0ic3ZnXzIiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0ibTEwMiwxMjcuMDUyNzNhMy42MjUsMy42MjUgMCAwIDEgMy42MjUsMy42MjVsMCw1OGEzLjYyNSwzLjYyNSAwIDAgMSAtNy4yNSwwbDAsLTU4YTMuNjI1LDMuNjI1IDAgMCAxIDMuNjI1LC0zLjYyNXoiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPg0KICA8L2c+DQogIDx0ZXh0IHRyYW5zZm9ybT0ibWF0cml4KDEuNTgzMzMsIDAsIDAsIDEuNTgzMzMsIC03LjI5MTY3LCAtMTQ3LjIwNSkiIHhtbDpzcGFjZT0icHJlc2VydmUiIHRleHQtYW5jaG9yPSJzdGFydCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMjQiIGlkPSJzdmdfNCIgeT0iMjc5LjM0NDczIiB4PSIxOS40NDczNyIgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2U9IiMwMDAiIGZpbGw9IiMwMDAwMDAiPuS4iuS8oOWbvueJhzwvdGV4dD4NCiA8L2c+DQo8L3N2Zz4="}})])]),t.imageUploading.length>0?t._l(t.imageUploading,(function(e){return r("el-col",{key:e.id,staticClass:"image-list-div",attrs:{span:4}},[r("div",{staticClass:"image-list-border"},[r("el-row",[r("el-col",[r("el-image",{staticClass:"div-inline",attrs:{src:e.src}})],1),r("el-col",[r("div",{staticStyle:{color:"#fff",position:"absolute",bottom:"0",width:"100%"}},[e.progress>0&&e.progress<100?r("el-row",{style:{width:"100%",padding:"0.4em","text-align":"center","background-color":"rgba(0,0,0,0.7)"}},[r("div",{staticStyle:{padding:"0.2em","background-color":"rgba(200,200,200,0.7)"}},[r("div",{style:{width:e.progress+"%","background-color":"rgb(50,180,50)","text-align":"right"}},[t._v(t._s(e.progress)+"%")])])]):t._e(),r("el-row",{style:{padding:"0.4em","text-align":"center","background-color":0===e.status?"rgba(255,0,0,0.7)":"rgba(0,0,0,0.7)"}},[t._v(" "+t._s(e.text)+" ")])],1)])],1)],1)])})):t._e(),e.imageList.length>0?t._l(e.imageList,(function(e){return r("el-col",{key:e.id,staticClass:"image-list-div",attrs:{span:4}},[r("div",{ref:"imageListBorder",refInFor:!0,staticClass:"image-list-border"},[r("el-row",{staticStyle:{width:"100%"}},[r("el-col",[r("el-image",{staticClass:"div-inline",attrs:{src:t.imageCdn[e.id].src,lazy:""},on:{load:function(r){return t.imageSrcLoad(e)},error:function(r){return t.imageSrcError(e)}}},[r("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[r("img",{staticClass:"el-image__inner",staticStyle:{width:"150px",height:"300px"},attrs:{src:t.lazyImgLoading}})])])],1),r("el-col",[r("div",{staticStyle:{color:"#fff",position:"absolute",bottom:"0",width:"100%"}},[2==e.status?r("el-row",{staticStyle:{padding:"0.4em","text-align":"center","background-color":"rgba(230,162,60,0.7)"}},[r("i",{staticClass:"el-icon-warning-outline"}),t._v("待审核 ")]):t._e(),0==e.status?r("el-row",{staticStyle:{padding:"0.4em","text-align":"center","background-color":"rgba(245,108,108,0.7)"}},[r("i",{staticClass:"el-icon-error"}),t._v(t._s(e.text||"审核失败")+" ")]):t._e(),e.info.size>0?r("el-row",{staticClass:"buttons",staticStyle:{padding:"0.4em","background-color":"rgba(0,0,0,0.7)","font-size":"0.8em"}},[r("el-col",[t._v(" 尺寸:"+t._s(e.info.width)+"*"+t._s(e.info.height)+" ")]),r("el-col",[t._v(" 文件大小:"+t._s(e.info.size>1024e3?(e.info.size/1024/1024).toFixed(2)+"MB":(e.info.size/1024).toFixed(2)+"KB")+" ")])],1):t._e(),1==e.status?r("el-row",{staticClass:"buttons",staticStyle:{padding:"0.4em","background-color":"rgba(0,0,0,0.7)","text-align":"center"}},[1==e.home?r("el-col",[r("el-button",{attrs:{loading:e.loading,type:"danger",size:"mini"},on:{click:function(r){return t.setImageHome(e)}}},[t._v("取消推荐")])],1):t._e(),0==e.home?r("el-col",[r("el-button",{attrs:{loading:e.loading,type:"success",size:"mini"},on:{click:function(r){return t.setImageHome(e)}}},[t._v("首页推荐")])],1):t._e()],1):t._e(),r("el-row",{staticClass:"buttons",staticStyle:{padding:"0.4em","background-color":"rgba(0,0,0,0.7)"}},[r("el-col",{attrs:{span:12}},[r("el-tooltip",{attrs:{content:2==e.status?"图片审核通过后可用":"图片已删除",disabled:1==e.status,placement:"left"}},[r("el-button",{attrs:{disabled:1!=e.status,type:"primary",size:"mini"},on:{click:function(r){return t.previewImageButton(e)}}},[t._v("原图")])],1)],1),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){return t.delList(e)}}},[t._v("删除")])],1)],1)],1)]),1==e.home?r("el-col",{staticStyle:{position:"absolute",top:"0",width:"100%","text-align":"right"}},[r("img",{staticStyle:{width:"30%",display:"inline-block"},attrs:{src:"/images/icon/home.png"}})]):t._e()],1)],1)])})):t._e()],2):t._e()],1)})),r("el-tab-pane",{attrs:{name:"addButton"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-button",{attrs:{type:"text",icon:"el-icon-plus"}}),0==t.imageCategoryList.length?r("span",[t._v("新增分类")]):t._e()],1)]),0==t.imageCategoryList.length?r("el-row",[r("h1",{staticStyle:{"text-align":"center"}},[t._v("请先添加图片分类")])]):t._e()],2)],1)]],2)},jt=[],Nt={components:{},data:function(){return{filterStatus:"-1",lazyImageHeight:400,loading:{page:!0},uploadFiles:[],lazyImgLoading:null,lazyImgError:null,imageSrcErrorBusy:!1,imageCdn:[],defaultCdnId:0,previewImage:null,cdn:[{domain:"https://n1.cdn.kgf.nr159.com:9527/",err:0,load:0,status:[{canuse:!0,fix:{prefix:"image/fail/",suffix:"/fail"}},{canuse:!0,fix:{prefix:"image/success/",suffix:"/success"}},{canuse:!0,fix:{prefix:"image/verify/",suffix:"/verify"}}]},{domain:"https://360.cdn.kgf.nr159.com/",err:0,load:0,status:[{canuse:!0,fix:{prefix:"image/fail/",suffix:"/fail"}},{canuse:!0,fix:{prefix:"image/success/",suffix:"/success"}},{canuse:!0,fix:{prefix:"image/verify/",suffix:"/verify"}}]},{domain:"https://cdn.kgf.nr159.com/",err:0,load:0,status:[{canuse:!0,fix:{prefix:"image/fail/",suffix:"/fail"}},{canuse:!0,fix:{prefix:"image/success/",suffix:"/success"}},{canuse:!0,fix:{prefix:"image/verify/",suffix:"/verify"}}]}]}},computed:{verifyList:function(){var t=[];return this.$store.getters["image/list/getList"].map((function(e){t.includes(e.verify_id)||2!=e.status||t.push(e.verify_id)})),t},imageUploading:function(){var t=this,e=this.uploadFiles.filter((function(e){return 1!=e.status&&e.type_id===t.$store.getters["image/category/tabId"]}));return e},tabName:{get:function(){return this.$store.getters["image/category/tabName"]},set:function(){}},imageCategoryList:function(){var t=this,e=this.$store.getters["image/category/getList"],r=this.$store.getters["image/list/getList"];return e.forEach((function(e){e.imageList=r.filter((function(r){return"undefined"==typeof t.imageCdn[r.id]&&t.imageCdnSrc(r),-1==t.filterStatus?r.type_id==e.id:3==t.filterStatus?r.type_id==e.id&&1==r.home:r.type_id==e.id&&r.status==t.filterStatus}))})),e},previewSrc:function(t){return function(t){var e=[];return e.push(this.imageSrc(t)),e}}},methods:{test:function(){},setImageHome:function(t){var e=this;this.$set(t,"loading",!0);var r={id:t.id,home:1==t.home?0:1};this.$store.dispatch("image/list/setImageHome",r).then((function(r){t.loading=!1,e.$message({type:"success",message:r.message})})).catch((function(r){t.loading=!1,e.$message({type:"info",message:r.message})}))},previewImageButton:function(t){var e="https://cdn.kgf.nr159.com/image/success/"+t.hash+"/download";window.open(e,"_blank")},imageCdnSrc:function(t){try{this.imageCdn[t.id].cdn}catch(i){this.$set(this.imageCdn,t.id,{}),this.$set(this.imageCdn[t.id],"src",this.lazyImgLoading),this.imageCdn[t.id].cdn=this.defaultCdnId}var e=this.imageCdn[t.id].cdn;this.imageCdn[t.id].src;try{if(e>=this.cdn.length)this.imageCdn[t.id].src=this.lazyImgSrc(":(");else if(1==this.cdn[e].status[t.status].canuse){var r=this.cdn[e].domain,a=this.cdn[e].status[t.status].fix;this.imageCdn[t.id].src=r+a.prefix+t.hash+a.suffix}else this.imageCdn[t.id].cdn++,this.imageCdnSrc(t)}catch(n){this.imageCdn[t.id].src=this.lazyImgError}},imageSrcLoad:function(t){try{this.cdn[this.imageCdn[t.id].cdn].load++}catch(e){}},imageSrcError:function(t){return this.imageCdn[t.id].src=this.lazyImgError,!1},selectFiles:function(t){var e=this,r=t.target.files,a=this,i=this.$store.getters["image/category/tabId"],n=this.$nr.loading("正在获取上传凭证...");this.$store.dispatch("image/list/getQiniuToken").then((function(t){n.close(),r.forEach((function(r,n){a.thumb(r).then((function(n){var s={type_id:i,progress:0,file:r,src:n,status:0,text:"队列中"};if(a.uploadFiles.push(s),r.size>5242880)return s.status=0,void(s.text="图片最大5M");s.text="正在上传";var o=new FormData;o.append("file",r),o.append("key",t.key),o.append("token",t.token),o.append("x:type_id",a.$store.getters["image/category/tabId"]);var l={onUploadProgress:function(t){s.progress=Math.floor(t.loaded/t.total*100),100==s.progress&&(s.text="等待服务器处理")}};vt(o,l).then((function(t){if(200===t.data.code)s.status=1,a.$store.commit("image/list/add",t.data);else{s.status=0;try{s.text=t.data.data.text}catch(e){s.text="审核不通过"}}})).catch((function(t){s.status=0,s.text="上传失败",e.$nr.reqErr(t)}))})).catch((function(t){e.$message({type:"info",message:"图片已损坏"+r.name})}))}))})).catch((function(t){n.close(),e.$message({type:"info",message:"获取上传凭证失败"+file.name})}))},addCategory:function(){var t=this;this.$prompt("请输入新分类的名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[\u4e00-\u9fa5a-zA-Z0-9]{1,5}$/,inputErrorMessage:"分类名称只能包含汉字、字母、数字，最多5位"}).then((function(e){var r=e.value,a=t.$nr.loading("正在添加["+r+"]..."),i={name:r};t.$store.dispatch("image/category/add",i).then((function(e){a.close(),t.$message({type:"success",message:"新分类["+r+"]创建成功!"})})).catch((function(e){a.close(),t.$alert(e.code+":"+e.message,e.errorSource)}))})).catch((function(){t.$message({type:"info",message:"新增分类操作已取消"})}))},delCategory:function(t){var e=this;if(0!==t.imageList.length)return this.$alert("请先删除分类下所有图片"),!1;this.$confirm("此操作将永久删除["+t.name+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var r=e.$nr.loading("正在删除["+t.name+"]...");e.$store.dispatch("image/category/del",t.id).then((function(a){r.close(),e.$message({type:"success",message:"删除["+t.name+"]成功!"})})).catch((function(t){r.close(),e.$alert(t.code+":"+t.message,t.errorSource)}))})).catch((function(){e.$message({type:"info",message:"删除["+t.name+"]操作已取消!"})}))},editCategory:function(t){var e=this;this.$prompt("请为["+t.name+"]输入新的名称","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[\u4e00-\u9fa5a-zA-Z0-9]{1,5}$/,inputErrorMessage:"分类名称由汉字、字母、数字组成，最多5位"}).then((function(r){var a=r.value;if(t.name==a)throw new Error;var i=e.$nr.loading("正在修改["+t.name+"]为["+a+"]..."),n={id:t.id,name:a};e.$store.dispatch("image/category/edit",n).then((function(r){i.close(),e.$message({type:"success",message:"修改["+t.name+"]为["+a+"]成功!"})})).catch((function(t){i.close(),e.$alert(t.code+":"+t.message,t.errorSource)}))})).catch((function(){e.$message({type:"info",message:"编辑["+t.name+"]操作已取消"})}))},delList:function(t){var e=this;this.$confirm("此操作将永久删除此图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var r=e.$nr.loading("正在删除图片...");e.$store.dispatch("image/list/del",t.id).then((function(t){r.close(),e.$message({type:"success",message:"删除[图片]成功!"})})).catch((function(t){r.close(),e.$alert(t.code+":"+t.message,t.errorSource)}))})).catch((function(){e.$message({type:"info",message:"删除[图片]操作已取消!"})}))},beforeChangeCategoryTab:function(t,e){if("addButton"==t)return this.addCategory(),!1},changeCategoryTab:function(t){try{var e=this.imageCategoryList[t.index].id;e!=this.$store.getters["image/category/tabId"]&&this.$store.commit("image/category/changeTab",e)}catch(r){}},updateVerifyStatus:function(){var t=this,e=this.$nr.loading("正在更新图片状态...");this.$store.dispatch("image/list/updateVerifyStatus",this.verifyList).then((function(r){r.data.forEach((function(e){t.$store.getters["image/list/getList"].forEach((function(r){r.verify_id==e.id&&t.imageCdnSrc(r)}))})),e.close(),t.$message({type:"success",message:r.message})})).catch((function(r){e.close(),201==r.code?t.$message({message:r.message}):t.$alert(r.code+":"+r.message,r.errorSource)}))},thumb:function(t){return new Promise((function(e,r){var a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result,a.onerror=function(t){r()},a.onload=function(){var t=400,r=2*t,a={};2*this.width>this.height?(a.w=t,a.h=this.height*t/this.width,a.x=0,a.y=(r-a.h)/2):(a.h=r,a.w=this.width*r/this.height,a.x=(t-a.w)/2,a.y=0);var i=document.createElement("canvas");i.setAttribute("width",t),i.setAttribute("height",r),i.getContext("2d").drawImage(this,a.x,a.y,a.w,a.h);var n=i.toDataURL("image/png");e(n)}},a.readAsDataURL(t)}))},lazyImgSrc:function(t){var e=document.createElement("canvas");e.width=200,e.height=400;var r=e.getContext("2d");r.fillStyle="#fff",r.fillRect(0,0,200,400),r.fillStyle="#000",r.textAlign="center",r.textBaseline="middle",r.font="bold 40px Arial",r.fillText(t,100,200);var a=e.toDataURL("image/jpeg",1);return r=null,e=null,a}},created:function(){var t=this,e=this.$nr.loading("正在获取分类列表...");this.lazyImgLoading=this.lazyImgSrc("载入中"),this.lazyImgError=this.lazyImgSrc("载入失败"),this.$store.dispatch("image/category/getList").then((function(r){e.text="正在获取图片列表...",t.$store.dispatch("image/list/getList").then((function(r){e.close(),t.loading.page=!1})).catch((function(e){t.loading.page=!1,t.$alert(e.code+":"+e.message,e.errorSource)}))})).catch((function(e){t.loading.page=!1,t.$alert(e.code+":"+e.message,e.errorSource)}))},destroyed:function(){this.$store.commit("image/list/destroyed")}},Ft=Nt,zt=(r("c13b"),Object(u["a"])(Ft,Et,jt,!1,null,null,null)),Bt=zt.exports,Dt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{padding:"20px"}},[r("el-row",{staticStyle:{"margin-bottom":"1em"}},[r("el-col",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$store.commit("shop/showChangePassword")}}},[t._v(" 修改密码 ")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$store.commit("shop/showOptions")}}},[t._v(" 设置店铺 ")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$store.commit("shop/showWxQcode")}}},[t._v(" 小程序码 ")])],1)],1),t.$store.getters["shop/optionsIsShow"]?r("Options"):t._e(),t.$store.getters["shop/changePasswordIsShow"]?r("ChangePassword"):t._e(),t.$store.getters["shop/wxQcodeIsShow"]?r("WxQcode"):t._e()],1)},Gt=[],Rt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-dialog",{attrs:{width:"35%","destroy-on-close":"",center:"",title:"修改密码",visible:t.$store.getters["shop/changePasswordIsShow"],"show-close":!1}},[r("el-form",{ref:"changePasswordForm",attrs:{"label-position":"left",model:t.changePasswordForm,"status-icon":"",rules:t.rules,"label-width":"5em"}},[r("el-form-item",{attrs:{label:"旧密码",prop:"oldPass"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.changePasswordForm.oldPass,callback:function(e){t.$set(t.changePasswordForm,"oldPass",e)},expression:"changePasswordForm.oldPass"}})],1),r("el-form-item",{attrs:{label:"新密码",prop:"pass"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.changePasswordForm.pass,callback:function(e){t.$set(t.changePasswordForm,"pass",e)},expression:"changePasswordForm.pass"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:t.changePasswordForm.checkPass,callback:function(e){t.$set(t.changePasswordForm,"checkPass",e)},expression:"changePasswordForm.checkPass"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("changePasswordForm")}}},[t._v("确 定")]),r("el-button",{on:{click:function(e){return t.closeForm("changePasswordForm")}}},[t._v("取 消")])],1)],1)],1)},qt=[],Ut={name:"ChangePassword",props:{},data:function(){var t=this,e=function(t,e,r){""===e?r(new Error("请输入当前密码")):e.length<8?r(new Error("密码最少8位")):r()},r=function(e,r,a){""===r?a(new Error("请输入密码")):r.length<8?a(new Error("密码最少8位")):t.changePasswordForm.oldPass===t.changePasswordForm.pass?a(new Error("新密码和旧密码不能相同!")):(""!==t.changePasswordForm.checkPass&&t.$refs.changePasswordForm.validateField("checkPass"),a())},a=function(e,r,a){""===r?a(new Error("请再次输入密码")):r!==t.changePasswordForm.pass?a(new Error("两次输入密码不一致!")):a()};return{dialogFormVisible:!1,changePasswordForm:{oldPass:"",pass:"",checkPass:""},rules:{oldPass:[{validator:e,trigger:"blur"}],pass:[{validator:r,trigger:"blur"}],checkPass:[{validator:a,trigger:"blur"}]}}},methods:{submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return!1;var r=e.$loading({lock:!0,text:"正在修改密码...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a={password:e.changePasswordForm.oldPass,new_password:e.changePasswordForm.pass};e.$store.dispatch("shop/changePassword",a).then((function(t){r.close(),e.$alert(t.message),e.closeForm("changePasswordForm")})).catch((function(t){r.close(),e.$alert(t.code+":"+t.message,t.errorSource)}))}))},closeForm:function(t){this.$refs[t].resetFields(),this.$store.commit("shop/hiddenChangePassword")}}},Wt=Ut,Jt=Object(u["a"])(Wt,Rt,qt,!1,null,"17b59a64",null),Ht=Jt.exports,Kt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-dialog",{attrs:{width:"35%","destroy-on-close":"",center:"",title:"店铺设置",visible:t.$store.getters["shop/optionsIsShow"],"show-close":!1}},[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"shopForm",attrs:{model:t.shopForm,"label-width":"5em","label-position":"left",rules:t.shopFormRules}},[r("el-form-item",{attrs:{label:"店铺名称",prop:"name"}},[r("el-input",{attrs:{placeholder:t.placeholder.name},model:{value:t.shopForm.name,callback:function(e){t.$set(t.shopForm,"name",e)},expression:"shopForm.name"}})],1),r("el-form-item",{attrs:{label:"公告",prop:"notices"}},[r("el-input",{attrs:{placeholder:t.placeholder.notices},model:{value:t.shopForm.notices,callback:function(e){t.$set(t.shopForm,"notices",e)},expression:"shopForm.notices"}})],1),r("el-form-item",{attrs:{label:"QQ",prop:"qq"}},[r("el-input",{attrs:{placeholder:t.placeholder.qq},model:{value:t.shopForm.qq,callback:function(e){t.$set(t.shopForm,"qq",e)},expression:"shopForm.qq"}})],1),r("el-form-item",{attrs:{label:"微信",prop:"wechat"}},[r("el-input",{attrs:{placeholder:t.placeholder.wechat},model:{value:t.shopForm.wechat,callback:function(e){t.$set(t.shopForm,"wechat",e)},expression:"shopForm.wechat"}})],1),r("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[r("el-input",{attrs:{placeholder:t.placeholder.phone},model:{value:t.shopForm.phone,callback:function(e){t.$set(t.shopForm,"phone",e)},expression:"shopForm.phone"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{disabled:t.loading,type:"primary"},on:{click:t.saveOptions}},[t._v("保存设置")]),r("el-button",{on:{click:t.closeWindow}},[t._v("取消")])],1)],1)],1)},Qt=[],Zt={name:"Options",components:{},data:function(){var t=this;return{loading:!0,placeholder:{name:"由1-15个汉字、数字、字母组成",notices:"由1-200个汉字、数字、字母组成",qq:"由5-11位数组组成",wechat:"由数字、字母、下划线_、横线-组成",phone:"由数字、横线-组成"},shopForm:{name:"",notices:"",qq:"",wechat:"",phone:""},shopFormRules:{name:[{validator:function(e,r,a){var i=/^[0-9a-zA-Z\u4e00-\u9fa5]{1,15}$/;i.test(r)||a(new Error(t.placeholder.name)),a()},trigger:"change"}],notices:[{validator:function(e,r,a){var i=/^[0-9a-zA-Z\u4e00-\u9fa5]{1,200}$/;i.test(r)||a(new Error(t.placeholder.notices)),a()},trigger:"change"}],qq:[{validator:function(e,r,a){var i=/^[0-9]{5,11}$/;i.test(r)||a(new Error(t.placeholder.qq)),a()},trigger:"change"}],wechat:[{validator:function(e,r,a){var i=/^[0-9a-zA-Z_-]{1,50}$/;i.test(r)||a(new Error(t.placeholder.wechat)),a()},trigger:"change"}],phone:[{validator:function(e,r,a){var i=/^[0-9a-z-]{1,20}$/;i.test(r)||a(new Error(t.placeholder.phone)),a()},trigger:"change"}]}}},methods:{saveOptions:function(){var t=this;this.$refs["shopForm"].validate((function(e){if(!e)return!1;var r=t.$loading({lock:!0,text:"正在保存设置...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),a=Object(b["a"])({},t.shopForm);t.$store.dispatch("shop/saveOptions",a).then((function(e){r.close(),t.$alert(e.message),t.closeWindow()})).catch((function(e){r.close(),t.$alert(e.code+":"+e.message,e.errorSource)}))}))},closeWindow:function(){this.$store.commit("shop/hiddenOptions")}},created:function(){var t=this;this.$store.dispatch("shop/getOptions").then((function(e){t.loading=!1,Object.assign(t.shopForm,e.data)})).catch((function(e){t.loading=!1}))}},Vt=Zt,Yt=Object(u["a"])(Vt,Kt,Qt,!1,null,null,null),Xt=Yt.exports,te=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-dialog",{attrs:{width:"35%","destroy-on-close":"",center:"",title:"微信小程序二维码",visible:t.$store.getters["shop/wxQcodeIsShow"],"show-close":!1}},[""===t.sid?[r("div",{directives:[{name:"loading",rawName:"v-loading",value:""===t.sid,expression:"sid === ''"}]})]:[r("div",{staticStyle:{"text-align":"center"}},[r("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{src:t.url,"preview-src-list":t.urls}})],1)],r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{loading:t.button.loading,disabled:""===t.sid,type:"primary"},on:{click:t.downloadWxQcode}},[t._v("下 载")]),r("el-button",{on:{click:function(e){return t.closeForm("changePasswordForm")}}},[t._v("取 消")])],1)],2)],1)},ee=[],re={name:"WxQcode",props:{},data:function(){return{loading:!0,sid:"",button:{loading:!1}}},computed:{url:function(){return"https://cdn.kgf.nr159.com/shop/"+this.sid+"/wxxcx_qrcode.jpg/thumbnail.png"},urls:function(){return[this.downloadUrl]},downloadUrl:function(){return"https://cdn.kgf.nr159.com/shop/"+this.sid+"/wxxcx_qrcode.jpg/download"}},methods:{saveFile:function(t,e){var r=document.createElementNS("http://www.w3.org/1999/xhtml","a");r.href=t,r.download=e;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(a)},downloadWxQcode:function(){var t=this,e=new Image,r=this.downloadUrl,a=this.button;a.loading=!0,e.crossOrigin="Anonymous",e.onerror=function(){a.loading=!1,t.$nr.errMsg("图片加载失败")},e.onload=Object(s["a"])(regeneratorRuntime.mark((function r(){var i,n,s,o,l,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:i="微信小程序二维码.png",300/2.54,n=document.createElement("canvas"),s=e.width,o=e.height,n.setAttribute("width",s),n.setAttribute("height",o),l=n.getContext("2d"),l.drawImage(e,0,0,s,o),c=n.toDataURL("image/png"),t.saveFile(c,i),a.loading=!1;case 12:case"end":return r.stop()}}),r)}))),e.src=r},closeForm:function(){this.$store.commit("shop/hiddenWxQcode")}},created:function(){var t=this;this.$store.dispatch("shop/getOptions").then((function(e){t.sid=e.sid})).catch((function(t){}))}},ae=re,ie=Object(u["a"])(ae,te,ee,!1,null,"4325ac1c",null),ne=ie.exports,se={comments:{},components:{ChangePassword:Ht,Options:Xt,WxQcode:ne},data:function(){return{loading:{save:!1}}},computed:{},methods:{saveChange:function(){var t=this;this.loading.save=!0,this.$store.dispatch("shop/saveChange").then((function(e){t.loading.save=!1})).catch((function(e){t.loading.save=!1,t.$nr.reqErr(e)}))}},created:function(){},destroyed:function(){}},oe=se,le=Object(u["a"])(oe,Dt,Gt,!1,null,null,null),ce=le.exports;a["default"].use(x["a"]);var de=[{path:"/login",name:"login",component:M},{path:"/shop/index",name:"index",meta:{title:"首页"},component:j},{path:"/shop/order",name:"order",meta:{title:"订单列表",menu:!0,icon:"el-icon-s-order"},component:it},{path:"/shop/material",name:"material",meta:{title:"型号管理",menu:!0,icon:"el-icon-mobile"},component:Tt},{path:"/shop/image",name:"image",meta:{title:"图库管理",menu:!0,icon:"el-icon-picture"},component:Bt},{path:"/shop/shop",name:"shop",meta:{title:"店铺管理",menu:!0,icon:"el-icon-user-solid"},component:ce},{path:"*",redirect:"/login"}],ue=new x["a"]({mode:"history",base:"/",linkExactActiveClass:"Active",linkActiveClass:"on",routes:de});ue.beforeEach((function(t,e,r){return r()}));var he=ue,me=r("4328"),ge=r.n(me);function fe(t){return localStorage.clear(),he.push({name:"login",query:{action:"logout"}}),Promise.reject({code:401,message:t})}function pe(t){var e=_.a.create({baseURL:"https://api.diy888.vip",timeout:3e3,validateStatus:function(t){return 200===t}});return e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",e.defaults.headers.post["X-Requested-With"]="XMLHttpRequest",e.interceptors.request.use((function(t){if("post"==t.method){t.data=ge.a.stringify(t.data);var e={url:t.url,time:Date.parse(new Date)/1e3,data:t.data};t.headers.common["X-Ca-Nonce"]=Mt()(ge.a.stringify(e))}return t}),(function(t){})),e.interceptors.response.use((function(t){return 401===t.data.code?fe(t.data.message):200!==t.data.code?Promise.reject(t.data):Promise.resolve(t.data)}),(function(t){var e={};return e.code=t.request.status,401===e.code?fe("登录超时"):(e.message=t.request.statusText,e.errorSource="服务器错误",0===t.request.status&&(e.message="连接超时",e.errorSource="网络错误"),""==t.request.statusText&&(e.message="未知错误"),Promise.reject(e))})),e(t)}function ve(t){var e=Object(b["a"])({},t);e.password=Mt()(Mt()(e.username)+Mt()(e.password));var r={method:"post",url:"/shop/postLoginForm",data:e};return pe(r)}function ye(t){var e={token:t},r={method:"post",url:"/shop/postCheckToken",data:e};return pe(r)}function we(t){var e={token:t},r={method:"post",url:"/shop/postLogout",data:e};return pe(r)}var be={methods:{changeMenu:function(){},logout:function(){var t=this;this.$confirm("确认退出?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.$nr.loading("正在退出登录");we(t.$store.getters["user/token"]).then((function(t){e.close()})).catch((function(t){e.close()}))})).catch((function(){}))}},components:{MyMenu:m,MyMenuButton:w},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=localStorage.token,void 0===r){e.next=11;break}if(a=/^\d+\|[a-zA-Z][0-9a-zA-Z]{5,15}\|[0-9a-z]{32}$/,!a.test(r)){e.next=9;break}return i=t.$nr.loading("正在检测登录状态"),e.next=7,ye(r).then((function(e){i.close(),t.$store.dispatch("user/successLogin",r),"/login"==t.$route.path&&t.$router.push({name:"index"})})).catch((function(e){t.$nr.alert(e.code+":"+e.message),i.close()}));case 7:e.next=11;break;case 9:t.$alert("总是在做一些无意义的忙碌，不论过了多久都还是老样子！"),localStorage.removeItem("token");case 11:t.$store.getters["user/isLogin"]||"/login"==t.$route.path||t.$router.push("/login");case 12:case"end":return e.stop()}}),e)})))()}},ke=be,_e=(r("034f"),Object(u["a"])(ke,i,n,!1,null,null,null)),xe=_e.exports,Ie=r("2f62"),Se={consoleLog:!0,menu:{open:!0}},$e=Se,Le={clg:function(t){return t.consoleLog},menuIsOpen:function(t){return t.menu.open}},Ce={changeMenuStatus:function(t){t.commit("changeMenuStatus")}},Me={changeMenuStatus:function(t){t.menu.open=!t.menu.open}},Ae=(r("1276"),function(){return{token:null}}),Pe={token:function(t){return t.token},username:function(t){return null!==t.token?t.token.split("|")[1]:null},isLogin:function(t){return null!==t.token}},Oe={successLogin:function(t,e){t.commit("setToken",e)},logout:function(t){t.commit("setToken",null)}},Te={setToken:function(t,e){t.token=e,null===e?localStorage.removeItem("token"):localStorage.setItem("token",e)},unsetToken:function(){Ae.token=null,localStorage.removeItem("token")}},Ee={namespaced:!0,state:Ae,getters:Pe,actions:Oe,mutations:Te};r("a434");function je(t){var e={token:t},r={method:"post",url:"/shop/getMaterialList",data:e};return pe(r)}function Ne(t){var e={token:t},r={method:"post",url:"/shop/getBrandList",data:e};return pe(r)}function Fe(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postAddMaterial",data:e};return pe(r)}function ze(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postEditMaterial",data:e};return pe(r)}function Be(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postDeleteMaterial",data:e};return pe(r)}function De(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/getMaterialToken",data:e};return pe(r)}var Ge=function(){return{name:"素材",count:0,shop:{},brands:[],brandList:{token:"",data:[]},materialList:{token:"",data:[]},diadog:{add:{show:!1}},clg:!1,materialId:0}},Re={clg:function(t){return t.clg},addIsShow:function(t){return t.diadog.add.show},getBrandList:function(t){return t.clg,t.brandList.data},getMaterialList:function(t){return t.clg,t.materialList.data},getMaterial:function(t){var e=t.materialList.data.filter((function(e){return e.id===t.materialId}));return e.length>0?e[0]:null},isEdit:function(t){return t.materialId>0}},qe={add:function(t,e){var r=t.rootGetters["user/token"],a={token:r,model_id:e.model_id,style_id:e.material_image_id>0?1:e.style_id,name:e.name,width:e.width,height:e.height,radius:1==e.radius?1:0,radius_size:1==e.radius?1*e.radius_size:0,reverse:1==e.reverse?1:0,rotate:e.rotate};return e.material_image_id>0&&(a.material_image_id=e.material_image_id),Fe(a).then((function(e){return t.commit("add",e.data),t.state.clg,Promise.resolve(e.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},edit:function(t,e){var r=t.rootGetters["user/token"],a={token:r,id:e.id,model_id:e.model_id,style_id:e.material_image_id>0?1:e.style_id,name:e.name,width:e.width,height:e.height,radius:1==e.radius?1:0,radius_size:1==e.radius?1*e.radius_size:0,reverse:1==e.reverse?1:0,rotate:e.rotate};return e.material_image_id>0&&(a.material_image_id=e.material_image_id),ze(a).then((function(e){return t.commit("edit",e.data),t.state.clg,Promise.resolve(e.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},delete:function(t,e){var r=t.rootGetters["user/token"],a={token:r,material_id:e.id};return Be(a).then((function(r){return t.commit("delete",e.id),t.state.clg,Promise.resolve(r)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},hiddenAdd:function(t){t.state.clg,t.commit("hiddenAdd")},getMaterialList:function(t){var e=t.rootGetters["user/token"],r="materialList",a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return t.commit("setMaterialList",{key:r,data:Object(b["a"])({},a)}),t.state.clg,Promise.resolve(a.data);t.state.clg,localStorage.removeItem(r)}return je(e).then((function(a){var i={key:r,data:{token:e,data:a.data}};return t.commit("setMaterialList",i),t.state.clg,Promise.resolve(a.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},getBrandList:function(t){t.commit("setClg",!0===t.rootGetters["clg"]);var e=t.rootGetters["user/token"],r="brandList",a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return t.commit("setBrandList",{key:r,data:Object(b["a"])({},a)}),t.state.clg,Promise.resolve(a.data);t.state.clg,localStorage.removeItem(r)}Ne(e).then((function(a){var i={key:r,data:{token:e,data:a.data}};return t.commit("setBrandList",i),t.state.clg,Promise.resolve(a.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},getMaterialToken:function(t){var e={token:t.rootGetters["user/token"]};return De(e).then((function(t){return Promise.resolve(t.data)})).catch((function(t){return Promise.reject(t)}))}},Ue={setClg:function(t,e){t.clg=!0===e},add:function(t,e){t.materialList.data.unshift(e),localStorage.setItem("materialList",JSON.stringify(t.materialList))},edit:function(t,e){var r=null;if(t.materialList.data=t.materialList.data.filter((function(t,a){return e.id!==t.id||(r=a,!1)})),null!=r)return t.materialList.data.splice(r,0,e),localStorage.setItem("materialList",JSON.stringify(t.materialList)),void t.clg;t.clg},delete:function(t,e){t.materialList.data=t.materialList.data.filter((function(t){return t.id!=e})),localStorage.setItem("materialList",JSON.stringify(t.materialList))},addMaterial:function(t){t.materialId=0,t.diadog.add.show=!0},editMaterial:function(t,e){t.materialId=e,t.diadog.add.show=!0},hiddenAdd:function(t){t.diadog.add.show=!1},setBrandList:function(t,e){t.clg,t.brandList=e.data,localStorage.setItem(e.key,JSON.stringify(e.data))},setMaterialList:function(t,e){t.clg,t.materialList=e.data,localStorage.setItem(e.key,JSON.stringify(e.data))},destroyed:function(t){t.brandList={token:"",data:[]},t.clg,t.materialList={token:"",data:[]},t.clg}},We={namespaced:!0,state:Ge,getters:Re,actions:qe,mutations:Ue},Je="ImageCategory";function He(t){var e={token:t},r={method:"post",url:"/shop/get"+Je+"List",data:e};return pe(r)}function Ke(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postAdd"+Je,data:e};return pe(r)}function Qe(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postEdit"+Je,data:e};return pe(r)}function Ze(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postDelete"+Je,data:e};return pe(r)}var Ve=function(){return{list:{token:"",data:[]},localKey:"imageCategoryList",name:"图片分类",clg:!1,tabId:0}},Ye={name:function(t){return t.name},getList:function(t){return t.list.data},localKey:function(t){return t.localKey},clg:function(t){return t.clg},tabId:function(t){return t.tabId},tabName:function(t){return"tab_"+t.tabId}},Xe={getList:function(t){var e=t.rootGetters["user/token"];t.commit("setClg",!0===t.rootGetters["clg"]);var r=t.getters["localKey"],a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return t.state.clg,t.commit("setList",a),a.code=200,a.cache=!0,Promise.resolve(a);t.state.clg,localStorage.removeItem(r)}return He(e).then((function(r){return r.token=e,t.commit("setList",r),t.state.clg,Promise.resolve(r.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},add:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,Ke(e).then((function(e){return t.commit("add",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},edit:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,Qe(e).then((function(e){return t.commit("edit",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},del:function(t,e){var r=t.rootGetters["user/token"],a={id:e,token:r};return Ze(a).then((function(r){return t.commit("del",e),Promise.resolve(r)})).catch((function(e){return t.state.clg,Promise.reject(e)}))}},tr={setList:function(t,e){var r=e.cache||!1;t.list=e,r||(e.data.cache=!1,localStorage.setItem(t.localKey,JSON.stringify(e))),0==t.tabId&&t.list.data.length>0&&(t.tabId=t.list.data[0].id),t.clg},add:function(t,e){t.list.data.push(e),t.tabId=e.id,localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},edit:function(t,e){var r=null;t.list.data=t.list.data.filter((function(t,a){return e.id!=t.id||(r=a,!1)})),null!==r&&(t.list.data.splice(r,0,e),localStorage.setItem(t.localKey,JSON.stringify(t.list))),t.clg},del:function(t,e){t.list.data=t.list.data.filter((function(t){return t.id!=e})),t.tabId=t.list.data.length>0?t.list.data[0].id:0,localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},setClg:function(t,e){t.clg=!0===e},changeTab:function(t,e){t.tabId=e,t.clg}},er={namespaced:!0,state:Ve,getters:Ye,actions:Xe,mutations:tr},rr=function(){return{list:{token:"",image_max:0,data:[]},localKey:"imageListList",name:"图片列表",clg:!1,activeId:0,timeout:200,qiniuTokenLocalKey:"imageListQiniuToekn"}},ar={name:function(t){return t.name},getList:function(t){return t.list.data},getImageListMax:function(t){return t.list.image_max},localKey:function(t){return t.localKey},clg:function(t){return t.clg},activeId:function(t){return t.clg,t.activeId},qiniuTokenLocalKey:function(t){return t.qiniuTokenLocalKey}},ir={timeout:function(t,e){var r=e||t.state.timeout;return new Promise((function(t){setTimeout((function(){t()}),r)}))},getQiniuToken:function(t){var e=t.rootGetters["user/token"],r=t.getters["qiniuTokenLocalKey"],a=localStorage.getItem(r);if(null!==a){a=JSON.parse(a);var i=Date.parse(new Date);if(i/=1e3,a.token===e&&i<a.data.expires-600)return t.state.clg,Promise.resolve(a.data);t.state.clg,localStorage.removeItem(r)}return gt(e).then((function(r){return r.token=e,t.commit("setQiniuToken",r),t.state.clg,Promise.resolve(r.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},getList:function(t){var e=t.rootGetters["user/token"];t.commit("setClg",!0===t.rootGetters["clg"]);var r=t.getters["localKey"],a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return a.data.forEach((function(t){t.loading=!1})),t.state.clg,t.commit("setList",a),a.cache=!0,t.dispatch("timeout").then((function(){return Promise.resolve(a)}));t.state.clg,localStorage.removeItem(r)}return dt(e).then((function(r){return r.token=e,t.commit("setList",r),t.state.clg,Promise.resolve(r.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},add:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,ut(e).then((function(e){return t.commit("add",e.data),t.state.clg,Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},edit:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,ht(e).then((function(e){return t.commit("edit",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},del:function(t,e){var r=t.rootGetters["user/token"],a={id:e,token:r};return mt(a).then((function(r){return t.commit("del",e),Promise.resolve(r)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},updateVerifyStatus:function(t,e){var r=t.rootGetters["user/token"],a={ids:e.toString(),token:r};return ft(a).then((function(e){var r=0,a=0,i=0;return e.data.forEach((function(e){t.state.list.data.forEach((function(t){t.verify_id==e.id&&(1==e.status?a++:0==e.status&&i++,r++,t.status=e.status,t.text=e.text)}))})),e.message="审核通过"+a+"张,失败"+i+"张",r>0&&t.commit("setLocalStorageList"),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))},setImageHome:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,pt(e).then((function(e){return t.commit("setImageHome",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))}},nr={setList:function(t,e){var r=e.cache||!1;t.list=e,r||(e.data.cache=!1,localStorage.setItem(t.localKey,JSON.stringify(e))),t.clg},add:function(t,e){t.list.image_max=e.image_max,t.list.data.unshift(e.data),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},edit:function(t,e){var r=null;t.list.data=t.list.data.filter((function(t,a){return e.id!=t.id||(r=a,!1)})),null!==r&&(t.list.data.splice(r,0,e),localStorage.setItem(t.localKey,JSON.stringify(t.list))),t.clg},del:function(t,e){t.list.data=t.list.data.filter((function(t){return t.id!=e})),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},setClg:function(t,e){t.clg=!0===e},activeId:function(t,e){t.activeId=e},destroyed:function(t){t.list={token:"",data:[]},t.clg},setQiniuToken:function(t,e){localStorage.setItem(t.qiniuTokenLocalKey,JSON.stringify(e)),t.clg},setLocalStorageList:function(t){localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},setImageHome:function(t,e){var r=null;t.list.data=t.list.data.filter((function(t,a){return e.id==t.id&&(r=a,t=Object.assign(t,e)),!0})),null!==r&&localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg}},sr={namespaced:!0,state:rr,getters:ar,actions:ir,mutations:nr},or="Shop";function lr(t){var e={token:t},r={method:"post",url:"/shop/get"+or+"List",data:e};return pe(r)}function cr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postAdd"+or,data:e};return pe(r)}function dr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postEdit"+or,data:e};return pe(r)}function ur(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postDelete"+or,data:e};return pe(r)}function hr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postChangePassword",data:e};return pe(r)}function mr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/get"+or+"Options",data:e};return pe(r)}function gr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postEdit"+or+"Options",data:e};return pe(r)}function fr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/post"+or+"SaveChange",data:e};return pe(r)}var pr=function(){return{list:{token:"",data:[]},localKey:"shop",name:"店铺管理",clg:!1,changePasswordIsShow:!1,optionsIsShow:!1,wxQcodeIsShow:!1,options:{localKey:"shopOptions",data:[]}}},vr={name:function(t){return t.name},getList:function(t){return t.list.data},localKey:function(t){return t.localKey},clg:function(t){return t.clg},changePasswordIsShow:function(t){return!0===t.changePasswordIsShow},optionsIsShow:function(t){return!0===t.optionsIsShow},wxQcodeIsShow:function(t){return!0===t.wxQcodeIsShow},optionsLocalKey:function(t){return t.options.localKey},optionsData:function(t){return t.options.data}},yr={getList:function(t){var e=t.rootGetters["user/token"];t.commit("setClg",!0===t.rootGetters["clg"]);var r=t.getters["localKey"],a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return t.state.clg,t.commit("setList",a),a.code=200,a.cache=!0,Promise.resolve(a);t.state.clg,localStorage.removeItem(r)}return lr(e).then((function(r){return r.token=e,t.commit("setList",r),t.state.clg,Promise.resolve(r.data)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},add:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,cr(e).then((function(e){return t.commit("add",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},edit:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,dr(e).then((function(e){return t.commit("edit",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},del:function(t,e){var r=t.rootGetters["user/token"],a={id:e,token:r};return ur(a).then((function(r){return t.commit("del",e),Promise.resolve(r)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},changePassword:function(t,e){var r=t.rootGetters["user/username"],a=t.rootGetters["user/token"],i={token:a,password:Mt()(Mt()(r)+Mt()(e.password)),new_password:Mt()(Mt()(r)+Mt()(e.new_password))};return hr(i).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.reject(t)}))},getOptions:function(t){var e=t.rootGetters["user/token"],r=t.getters["optionsLocalKey"],a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return Promise.resolve(a);t.state.clg,localStorage.removeItem(r)}var i={token:e};return mr(i).then((function(r){return r.token=e,t.commit("setOptions",r),Promise.resolve(r)})).catch((function(t){return Promise.reject(t)}))},saveOptions:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,gr(e).then((function(e){return e.token=r,t.commit("setOptions",e),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))},saveChange:function(t){var e=t.rootGetters["user/token"],r={token:e};return fr(r).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.reject(t)}))}},wr={setList:function(t,e){var r=e.cache||!1;t.list=e,r||(e.data.cache=!1,localStorage.setItem(t.localKey,JSON.stringify(e))),t.clg},add:function(t,e){t.list.data.push(e),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},edit:function(t,e){var r=null;t.list.data=t.list.data.filter((function(t,a){return e.id!=t.id||(r=a,!1)})),null!==r&&(t.list.data.splice(r,0,e),localStorage.setItem(t.localKey,JSON.stringify(t.list))),t.clg},del:function(t,e){t.list.data=t.list.data.filter((function(t){return t.id!=e})),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},setClg:function(t,e){t.clg=!0===e},showChangePassword:function(t){t.changePasswordIsShow=!0},hiddenChangePassword:function(t){t.changePasswordIsShow=!1},showOptions:function(t){t.optionsIsShow=!0},hiddenOptions:function(t){t.optionsIsShow=!1},showWxQcode:function(t){t.wxQcodeIsShow=!0},hiddenWxQcode:function(t){t.wxQcodeIsShow=!1},setOptions:function(t,e){t.options.data=e,localStorage.setItem(t.options.localKey,JSON.stringify(t.options.data))}},br={namespaced:!0,state:pr,getters:vr,actions:yr,mutations:wr},kr="OrderList";function _r(t){var e={token:t},r={method:"post",url:"/shop/get"+kr+"Index",data:e};return pe(r)}function xr(t){var e={method:"post",url:"/shop/get"+kr+"ById",data:t};return pe(e)}function Ir(t){var e={method:"post",url:"/shop/get"+kr+"Before",data:t};return pe(e)}function Sr(t){var e={method:"post",url:"/shop/get"+kr+"After",data:t};return pe(e)}function $r(t){var e={method:"post",url:"/shop/post"+kr+"ChangeStatus",data:t};return pe(e)}function Lr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postAdd"+kr,data:e};return pe(r)}function Cr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postEdit"+kr,data:e};return pe(r)}function Mr(t){var e=Object(b["a"])({},t),r={method:"post",url:"/shop/postDelete"+kr,data:e};return pe(r)}var Ar=function(){return{list:{token:"",data:[],lasttime:0},localKey:"orderList",name:"订单列表",clg:!1,printer:{name:"",line:!0,lineWidth:2,autoDone:!0,show:!1,preview:!1,print_text:["订单编号","素材信息"]},printerLocalKey:"orderListPrinter"}},Pr={name:function(t){return t.name},getList:function(t){return t.list.data},localKey:function(t){return t.localKey},clg:function(t){return t.clg},getPrinter:function(t){if(""==t.printer.name){var e=localStorage.getItem(t.printerLocalKey);null!==e&&(t.printer=Object.assign(t.printer,JSON.parse(e)))}return t.printer},getPrinterName:function(t){if(""==t.printer.name){var e=localStorage.getItem(t.printerLocalKey);null!==e&&(t.printer=Object.assign(t.printer,JSON.parse(e)))}return t.printer.name},getCanvasLineWidth:function(t){return t.printer.lineWidth},printerSettingIsShow:function(t){return t.printer.show}},Or={getIndex:function(t){var e=t.rootGetters["user/token"];t.commit("setClg",!0===t.rootGetters["clg"]);var r=t.getters["localKey"],a=localStorage.getItem(r);if(null!==a){if(a=JSON.parse(a),a.token===e)return a.cache=!0,t.state.clg,t.commit("setList",a),a.code=200,a.cache=!0,a.limit=a.data.length,Promise.resolve(a);t.state.clg,localStorage.removeItem(r)}return _r(e).then((function(r){return r.token=e,r.data.forEach((function(t){t.keywords=t.keywords.toLowerCase()})),t.commit("setList",r),t.state.clg,Promise.resolve(r)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},getBefore:function(t){var e=t.rootGetters["user/token"],r=t.state.list.data.length>0?t.state.list.data.slice(0)[0].order_id:1,a={token:e,order_id:r};return Ir(a).then((function(r){return 200==r.code?(r.data.length>0&&(r.data.forEach((function(t){t.keywords=t.keywords.toLowerCase()})),r.token=e,t.commit("setBefore",r)),Promise.resolve(r)):Promise.reject(r)})).catch((function(t){return Promise.reject(t)}))},getAfter:function(t){if(t.state.list.data.length>0){var e=t.rootGetters["user/token"],r=t.state.list.data.slice(-1)[0].order_id,a={token:e,order_id:r};return Sr(a).then((function(r){return 200==r.code?(r.data.length>0&&(r.data.forEach((function(t){t.keywords=t.keywords.toLowerCase()})),r.token=e,t.commit("setAfter",r)),Promise.resolve(r)):Promise.reject(r)})).catch((function(t){return Promise.reject(t)}))}return Promise.reject("什么也没有!")},getById:function(t,e){var r=t.rootGetters["user/token"],a={token:r,order_id:e};return xr(a).then((function(t){return Promise.resolve(t)})).catch((function(t){return Promise.reject(t)}))},changeOrderStatus:function(t,e){return e.token=t.rootGetters["user/token"],$r(e).then((function(e){var r=t.state.list.data;return r.some((function(r,a){if(r.order_id==e.data.order_id)return t.commit("changeStatus",{index:a,status:e.data.status}),!0})),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))},add:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,Lr(e).then((function(e){return t.commit("add",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},edit:function(t,e){var r=t.rootGetters["user/token"];return e.token=r,Cr(e).then((function(e){return t.commit("edit",e.data),Promise.resolve(e)})).catch((function(e){return t.state.clg,Promise.reject(e)}))},del:function(t,e){var r=t.rootGetters["user/token"],a={id:e,token:r};return Mr(a).then((function(r){return t.commit("del",e),Promise.resolve(r)})).catch((function(e){return t.state.clg,Promise.reject(e)}))}},Tr={setList:function(t,e){var r=e.cache||!1;t.list=e,r||(e.data.cache=!1,localStorage.setItem(t.localKey,JSON.stringify(t.list))),t.clg},setBefore:function(t,e){var r=Object(b["a"])({},e);r.data.reverse(),t.list.data=r.data.concat(t.list.data),t.list.data.length>5e3&&(t.list.data=t.list.data.slice(0,5e3)),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},setAfter:function(t,e){var r=Object(b["a"])({},e);t.list.data=t.list.data.concat(r.data),t.list.data.length>5e3&&(t.list.data=t.list.data.slice(0,5e3)),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},changeStatus:function(t,e){t.list.data[e.index].status=e.status,localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},add:function(t,e){t.list.data.push(e),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},edit:function(t,e){var r=null;t.list.data=t.list.data.filter((function(t,a){return e.id!=t.id||(r=a,!1)})),null!==r&&(t.list.data.splice(r,0,e),localStorage.setItem(t.localKey,JSON.stringify(t.list))),t.clg},del:function(t,e){t.list.data=t.list.data.filter((function(t){return t.id!=e})),localStorage.setItem(t.localKey,JSON.stringify(t.list)),t.clg},setClg:function(t,e){t.clg=!0===e},setPrintName:function(t,e){t.printer.name=e},hiddenPrinterSetting:function(t){t.printer.show=!1},showPrinterSetting:function(t){t.printer.show=!0},setPrinterSetting:function(t,e){t.printer=Object(b["a"])({},e),localStorage.setItem(t.printerLocalKey,JSON.stringify(t.printer)),t.clg}},Er={namespaced:!0,state:Ar,getters:Pr,actions:Or,mutations:Tr};a["default"].use(Ie["a"]);var jr=new Ie["a"].Store({state:$e,getters:Le,actions:Ce,mutations:Me,modules:{user:Ee,material:We,"image/category":er,"image/list":sr,shop:br,"order/list":Er}}),Nr=(r("9e1f"),r("450d"),r("6ed5")),Fr=r.n(Nr),zr=(r("6b30"),r("c284")),Br=r.n(zr),Dr=(r("e612"),r("dd87")),Gr=r.n(Dr),Rr=(r("075a"),r("72aa")),qr=r.n(Rr),Ur=(r("5466"),r("ecdf")),Wr=r.n(Ur),Jr=(r("38a0"),r("ad41")),Hr=r.n(Jr),Kr=(r("e960"),r("b35b")),Qr=r.n(Kr),Zr=(r("eca7"),r("3787")),Vr=r.n(Zr),Yr=(r("425f"),r("4105")),Xr=r.n(Yr),ta=(r("3c52"),r("0d7b")),ea=r.n(ta),ra=(r("fe07"),r("6ac5")),aa=r.n(ra),ia=(r("b5d8"),r("f494")),na=r.n(ia),sa=(r("8bd8"),r("4cb2")),oa=r.n(sa),la=(r("ce18"),r("f58e")),ca=r.n(la),da=(r("4ca3"),r("443e")),ua=r.n(da),ha=(r("0fb7"),r("f529")),ma=r.n(ha),ga=(r("bdc7"),r("aa2f")),fa=r.n(ga),pa=(r("de31"),r("c69e")),va=r.n(pa),ya=(r("a769"),r("5cc3")),wa=r.n(ya),ba=(r("a673"),r("7b31")),ka=r.n(ba),_a=(r("adec"),r("3d2d")),xa=r.n(_a),Ia=(r("be4f"),r("896a")),Sa=r.n(Ia),$a=(r("d4df"),r("7fc1")),La=r.n($a),Ca=(r("c526"),r("1599")),Ma=r.n(Ca),Aa=(r("560b"),r("dcdc")),Pa=r.n(Aa),Oa=(r("b8e0"),r("a4c4")),Ta=r.n(Oa),Ea=(r("279e"),r("7d94")),ja=r.n(Ea),Na=(r("e2f3"),r("06f9")),Fa=r.n(Na),za=(r("0c67"),r("299c")),Ba=r.n(za),Da=(r("6611"),r("e772")),Ga=r.n(Da),Ra=(r("1f1a"),r("4e4b")),qa=r.n(Ra),Ua=(r("a7cc"),r("df33")),Wa=r.n(Ua),Ja=(r("10cb"),r("f3ad")),Ha=r.n(Ja),Ka=(r("acb6"),r("c673")),Qa=r.n(Ka),Za=(r("f4f9"),r("c2cc")),Va=r.n(Za),Ya=(r("7a0f"),r("0f6c")),Xa=r.n(Ya),ti=(r("1951"),r("eedf")),ei=r.n(ti);a["default"].use(ei.a),a["default"].use(Xa.a),a["default"].use(Va.a),a["default"].use(Qa.a),a["default"].use(Ha.a),a["default"].use(Wa.a),a["default"].use(qa.a),a["default"].use(Ga.a),a["default"].use(Ba.a),a["default"].use(Fa.a),a["default"].use(ja.a),a["default"].use(Ta.a),a["default"].use(Pa.a),a["default"].use(Ma.a),a["default"].use(La.a),a["default"].use(Sa.a.directive),a["default"].prototype.$loading=Sa.a.service,a["default"].use(xa.a),a["default"].use(ka.a),a["default"].use(wa.a),a["default"].use(va.a),a["default"].use(fa.a),a["default"].prototype.$message=ma.a,a["default"].use(ua.a),a["default"].use(ca.a),a["default"].use(oa.a),a["default"].use(na.a),a["default"].use(aa.a),a["default"].use(ea.a),a["default"].use(Xr.a),a["default"].use(Vr.a),a["default"].use(Qr.a),a["default"].use(Hr.a),a["default"].use(Wr.a),a["default"].use(qr.a),a["default"].use(Gr.a),a["default"].use(Br.a),a["default"].prototype.$msgbox=Fr.a,a["default"].prototype.$alert=Fr.a.alert,a["default"].prototype.$confirm=Fr.a.confirm,a["default"].prototype.$prompt=Fr.a.prompt;var ri=r("caf9"),ai=(r("e05f"),r("487a")),ii=r.n(ai),ni=r("53ca"),si=void 0,oi={reqSuc:function(t){var e=function(t){ma()({message:t,type:"success"})};if("string"!==typeof t)try{t.data.length>0?e("成功加载["+t.data.length+"]条数据"):e("没有新数据")}catch(r){}else e(t)},reqDone:function(t){ma()({message:t.message,type:"success"})},reqErr:function(t){"object"==Object(ni["a"])(t)?(t.code=t.code||0,t.message=t.message||"未知错误",t.errorSource=t.errorSource||"错误",Fr.a.alert(t.code+":"+t.message,t.errorSource)):Fr.a.alert(t,"错误提示")},netErr:function(t){si.reqErr(t)},errMsg:function(t){ma.a.error(t)},doneMsg:function(t){ma()({message:t,type:"success"})},alert:function(t,e){e=e||"错误提示",Fr.a.alert(t,e,{dangerouslyUseHTMLString:!0})},loading:function(t){return t=t||"数据载入中...",Sa.a.service({lock:!0,text:t,spinner:"el-icon-loading",background:"rgba(50, 200, 50, 0.7)"})}},li=r("f7fe"),ci=r.n(li);a["default"].config.productionTip=!1,a["default"].use(ri["a"]),a["default"].use(ii.a),a["default"].prototype.$nr=oi;var di={vid:"5e8ea65555d0def952146d61",type:"invisible",scene:0,offline_server:"http://www.baidu.com"};a["default"].use(ci()(di)),new a["default"]({store:jr,router:he,render:function(t){return t(xe)}}).$mount("#app")},8203:function(t,e,r){},"85ec":function(t,e,r){},"91bb":function(t,e,r){"use strict";var a=r("a296"),i=r.n(a);i.a},"9f49":function(t,e,r){},a296:function(t,e,r){},b205:function(t,e,r){"use strict";var a=r("9f49"),i=r.n(a);i.a},b322:function(t,e,r){},c13b:function(t,e,r){"use strict";var a=r("8203"),i=r.n(a);i.a},d2ab:function(t,e,r){"use strict";var a=r("b322"),i=r.n(a);i.a},ec2e:function(t,e,r){}});